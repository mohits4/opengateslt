<?php
include_once dirname( __FILE__ ) .'/Math/BigInteger.php';
include_once dirname( __FILE__ ) .'/Crypt/RSA.php';
include_once dirname( __FILE__ ) . '/eveonline/vendor/autoload.php';
use Pheal\Pheal;
use Pheal\Core\Config;
class Mo_Oauth_Widget extends WP_Widget
{
    public function __construct()
    {
        mo_oauth_client_update_option("\x68\157\x73\164\137\156\x61\x6d\145", "\x68\x74\164\160\x73\72\x2f\x2f\x6c\157\147\x69\156\56\x78\145\143\165\162\151\x66\x79\56\143\157\155");
        add_action("\x77\160\137\145\x6e\161\165\145\x75\145\137\163\143\x72\x69\x70\x74\163", array($this, "\162\x65\x67\x69\x73\164\x65\162\137\160\154\x75\x67\151\x6e\x5f\x73\x74\x79\x6c\145\163"));
        add_action("\151\156\x69\164", array($this, "\155\157\x5f\x6f\141\165\x74\x68\137\x73\164\141\162\x74\x5f\163\145\163\x73\151\x6f\x6e"));
        add_action("\x77\x70\x5f\154\157\147\x6f\x75\x74", array($this, "\155\x6f\x5f\x6f\141\165\164\x68\137\x65\x6e\x64\x5f\163\x65\x73\163\151\x6f\x6e"));
        parent::__construct("\155\157\137\157\141\x75\164\x68\x5f\167\151\144\x67\x65\x74", "\x6d\151\x6e\151\117\x72\x61\156\147\x65\x20\117\x41\165\x74\150\40\x4c\x6f\147\151\x6e", array("\x64\x65\x73\x63\162\x69\160\164\x69\x6f\156" => __("\114\x6f\147\151\x6e\40\x74\x6f\x20\x41\x70\x70\163\x20\167\151\x74\x68\x20\x4f\x41\165\164\x68", "\146\x6c\x77")));
    }
    function mo_oauth_start_session()
    {
        if (session_id()) {
            goto ck;
        }
        session_start();
        ck:
        if (!(isset($_REQUEST["\157\160\164\151\157\x6e"]) and $_REQUEST["\157\x70\x74\x69\x6f\x6e"] == "\164\145\x73\164\x61\x74\164\x72\155\141\160\x70\151\x6e\x67\143\157\156\x66\151\x67")) {
            goto Nn;
        }
        $eS = $_REQUEST["\141\160\x70"];
        wp_redirect(site_url() . "\x3f\x6f\160\x74\151\x6f\156\x3d\x6f\141\x75\x74\150\x72\x65\144\x69\162\x65\x63\x74\46\x61\x70\160\x5f\156\141\155\x65\x3d" . urlencode($eS) . "\46\164\145\163\164\75\x74\162\165\x65");
        die;
        Nn:
        if (!(isset($_REQUEST["\x6f\x70\x74\151\157\156"]) and $_REQUEST["\157\x70\164\x69\x6f\x6e"] == "\164\x65\x73\164\160\141\163\163\167\157\162\144\147\162\141\156\x74")) {
            goto Lx;
        }
        $eS = $_REQUEST["\x61\160\160"];
        $cS = '';
        $uN = '';
        if (!isset($_REQUEST["\144\x65\x74\x61\151\154\163"])) {
            goto je;
        }
        $pG = explode("\55", $_REQUEST["\x64\x65\164\x61\x69\154\163"]);
        if (!(count($pG) < 2)) {
            goto xe;
        }
        wp_die("\120\154\145\x61\x73\145\x20\x63\x68\x65\143\153\40\x20\x74\x68\145\40\143\162\x65\144\x65\156\x74\x69\x61\154\x73\x20\160\162\157\166\151\x64\x65\144\x2e");
        xe:
        $cS = base64_decode($pG[1]);
        $uN = base64_decode($pG[0]);
        je:
        $vQ = mo_oauth_client_get_option("\155\157\137\157\141\x75\164\x68\x5f\141\x70\160\x73\137\154\x69\163\x74");
        $X6 = $Y3 = false;
        foreach ($vQ as $OY => $AO) {
            if (!($OY === $eS)) {
                goto Uu;
            }
            $X6 = $AO;
            goto hd;
            Uu:
            uo:
        }
        hd:
        $L0 = new Mo_OAuth_Hanlder();
        $Is = $L0->getToken($X6["\141\x63\x63\145\163\163\164\x6f\x6b\145\156\x75\x72\x6c"], "\x70\x61\x73\163\x77\157\162\144", $X6["\x63\x6c\151\x65\156\164\x69\x64"], $X6["\x63\154\x69\x65\156\x74\x73\x65\x63\x72\145\x74"], '', $X6["\x72\x65\x64\151\x72\145\143\164\165\162\x69"], $cS, $uN, false);
        $Is = json_decode($Is, true);
        $Y3 = false;
        if (isset($Is["\x65\x72\162\157\x72\137\144\x65\163\x63\162\x69\x70\x74\151\x6f\156"])) {
            goto H6;
        }
        if (isset($Is["\145\162\162\157\x72"])) {
            goto IG;
        }
        if (isset($Is["\x61\x63\143\145\x73\x73\x5f\x74\x6f\153\145\x6e"])) {
            goto Jb;
        }
        echo "\x3c\x64\151\x76\40\x63\x6c\x61\x73\163\75\155\157\x61\165\x74\x68\145\162\x72\x6f\162\x3e\101\143\x63\145\163\x73\x20\164\x6f\x6b\x65\x6e\40\156\x6f\x74\x20\162\x65\143\x65\x69\x76\145\x64\x2e\40\x50\154\x65\141\x73\145\x20\x63\x68\145\143\x6b\x20\171\x6f\165\162\40\x63\157\x6e\x66\x69\x67\165\162\141\164\151\157\156\x2e\74\x2f\x64\x69\166\76";
        goto O6;
        Jb:
        $hf = $Is["\x61\x63\143\x65\x73\163\x5f\x74\x6f\153\x65\x6e"];
        $h8 = $X6["\x72\145\x73\157\x75\162\143\x65\157\167\156\x65\x72\144\145\x74\x61\x69\154\x73\x75\x72\154"];
        if (!(substr($h8, -1) == "\75")) {
            goto SL;
        }
        $h8 .= $hf;
        SL:
        $Y3 = $L0->getResourceOwner($h8, $hf);
        O6:
        goto FJ;
        IG:
        echo "\74\144\x69\x76\40\143\154\141\163\163\75\x6d\x6f\x61\165\x74\x68\145\x72\x72\157\162\76" . $Is["\x65\x72\162\157\x72"] . "\x3c\57\x64\151\166\76";
        FJ:
        goto xx;
        H6:
        echo "\74\x64\x69\x76\x20\143\x6c\x61\x73\163\75\x6d\x6f\x61\x75\x74\x68\x65\x72\x72\x6f\x72\x3e" . $Is["\x65\x72\162\x6f\162\137\x64\x65\163\x63\x72\151\x70\164\x69\x6f\x6e"] . "\74\x2f\144\x69\166\76";
        xx:
        if (isset($Y3) && $Y3) {
            goto iO;
        }
        wp_die("\124\x68\x65\x72\145\40\167\141\x73\x20\163\157\155\145\40\160\x72\x6f\142\x6c\x65\155\x20\x69\156\40\141\x75\164\x68\145\156\x74\151\x63\x61\164\x69\x6f\156\x2e\x20\x50\154\x65\141\163\x65\x20\x54\162\x79\x20\x41\x67\141\x69\156\x2e");
        goto vA;
        iO:
        echo "\15\12\11\x9\11\11\74\x73\x74\x79\x6c\x65\x3e\56\x6d\157\x6f\x61\x75\164\x68\164\x65\163\x74\x63\157\x6e\x66\151\147\x74\x61\142\154\145\173\155\x61\162\147\x69\156\55\x6c\x65\146\x74\x3a\x32\60\160\170\x3b\142\157\x72\x64\145\162\x2d\143\x6f\154\154\x61\160\x73\x65\72\40\x63\157\154\x6c\x61\x70\x73\145\73\x7d\56\x6d\157\x6f\141\x75\x74\150\164\145\163\x74\x63\157\x6e\x66\151\x67\x74\x61\142\x6c\x65\x2c\x20\x2e\155\157\157\141\165\164\x68\164\145\x73\164\x63\x6f\x6e\146\x69\147\164\141\142\154\145\x20\164\x64\x2c\40\x2e\x6d\x6f\x6f\x61\165\x74\x68\164\x65\x73\x74\x63\x6f\156\x66\151\x67\164\x61\x62\x6c\145\40\164\150\x20\x7b\x62\x6f\x72\x64\145\x72\72\x20\x31\x70\x78\40\163\157\154\151\144\x20\x62\154\x61\143\153\73\160\x61\144\x64\151\x6e\x67\x3a\x34\x70\170\175\74\x2f\x73\x74\171\154\x65\76";
        echo "\x3c\164\141\x62\154\145\x20\x63\154\141\163\x73\75\x27\x6d\157\157\x61\x75\164\x68\164\x65\x73\164\143\x6f\156\x66\x69\147\x74\141\142\154\x65\x27\x3e\x3c\x74\x72\76\74\164\x68\x3e\x41\x74\164\x72\151\x62\165\164\x65\40\116\141\x6d\x65\74\x2f\x74\x68\x3e\74\x74\150\76\x41\164\x74\x72\x69\142\165\x74\x65\x20\x56\141\x6c\165\145\x3c\x2f\164\x68\x3e\74\x2f\164\x72\x3e";
        test_attr_mapping_config('', $Y3, array());
        echo "\x3c\x2f\164\141\142\x6c\x65\76\x3c\x62\162\76\x3c\x62\162\76";
        die;
        vA:
        Lx:
    }
    function mo_oauth_end_session()
    {
        if (session_id()) {
            goto Xb;
        }
        session_start();
        Xb:
        session_destroy();
    }
    public function widget($V1, $G6)
    {
        extract($V1);
        echo $V1["\142\x65\x66\x6f\162\x65\137\x77\151\x64\x67\x65\x74"];
        if (empty($JV)) {
            goto fU;
        }
        echo $V1["\142\x65\146\x6f\x72\145\137\164\151\164\154\145"] . $JV . $V1["\141\x66\164\145\162\x5f\x74\151\x74\154\145"];
        fU:
        if (mo_oauth_client_get_option("\x6d\157\x5f\141\143\x74\x69\166\x61\x74\145\137\163\x69\x6e\147\154\x65\137\x6c\157\147\151\156\137\146\x6c\157\x77")) {
            goto Jx;
        }
        echo $this->mo_oauth_login_form();
        goto iz;
        Jx:
        $this->mo_activate_single_login_flow_form();
        iz:
        echo $V1["\x61\146\164\x65\162\x5f\x77\151\144\x67\x65\x74"];
    }
    public function update($sv, $hC)
    {
        $G6 = array();
        if (!isset($sv["\167\x69\x64\x5f\164\x69\x74\x6c\x65"])) {
            goto RU;
        }
        $G6["\167\x69\144\x5f\x74\151\164\154\145"] = strip_tags($sv["\167\151\x64\x5f\164\x69\x74\x6c\145"]);
        RU:
        return $G6;
    }
    public function mo_activate_single_login_flow_form()
    {
        $this->mo_oauth_load_login_script();
        if (empty(mo_oauth_client_get_option("\155\x6f\x5f\x6f\x61\x75\x74\x68\x5f\143\x6c\151\145\x6e\x74\x5f\143\x6f\155\155\157\156\137\x6c\157\x67\x69\x6e\x5f\x62\x75\164\x74\x6f\x6e\137\x64\x69\163\160\x6c\141\x79\137\156\141\155\x65"))) {
            goto QE;
        }
        $UC = mo_oauth_client_get_option("\155\x6f\137\157\x61\165\164\150\137\x63\154\151\x65\x6e\x74\137\x63\x6f\x6d\x6d\x6f\156\137\x6c\x6f\147\151\x6e\137\x62\x75\164\x74\157\156\137\144\x69\x73\160\154\141\x79\x5f\x6e\141\x6d\x65");
        goto Bx;
        QE:
        $UC = "\x4c\x6f\x67\151\156";
        Bx:
        $so = mo_oauth_client_get_option("\x6d\x6f\x5f\x6f\x61\165\164\150\x5f\154\x6f\x67\151\x6e\x5f\151\143\157\x6e\x5f\163\160\141\x63\145");
        $kT = mo_oauth_client_get_option("\x6d\x6f\137\x6f\141\165\164\150\x5f\154\157\147\x69\156\x5f\151\x63\157\156\137\x63\165\163\x74\x6f\155\x5f\167\151\144\164\150");
        $e5 = mo_oauth_client_get_option("\155\157\137\x6f\141\165\x74\150\137\154\157\x67\x69\156\x5f\x69\x63\157\x6e\x5f\x63\x75\163\x74\x6f\155\x5f\150\x65\151\147\x68\164");
        $Ra = mo_oauth_client_get_option("\155\157\137\x6f\141\x75\164\x68\x5f\154\x6f\147\x69\156\137\x69\x63\157\156\x5f\x63\165\163\x74\157\x6d\137\142\x6f\x75\x6e\144\141\x72\171");
        if (is_user_logged_in()) {
            goto fQ;
        }
        $Rb = "\74\141\x20\x68\x72\145\146\x3d\x22\152\x61\166\141\163\143\x72\151\x70\164\x3a\166\157\x69\x64\50\x30\51\x22\40\157\156\x63\x6c\x69\143\x6b\75\x22\155\157\117\101\x75\x74\150\103\x6f\155\x6d\157\x6e\x4c\157\x67\151\156\50\47" . $UC . "\x27\51\x3b\x22\x20\163\164\x79\x6c\x65\75\42\143\x6f\154\x6f\x72\x3a\x77\150\151\164\x65\x3b\40\x77\151\144\x74\150\x3a" . $kT . "\x70\x78\x20\x21\x69\x6d\160\157\162\164\x61\156\x74\x3b\x70\141\144\x64\x69\156\147\55\x74\157\x70\x3a" . $e5 . "\160\170\x20\x21\x69\155\160\157\162\164\x61\156\x74\x3b\160\141\144\144\x69\x6e\x67\55\x62\x6f\164\x74\157\x6d\x3a" . $e5 . "\x70\x78\x20\x21\x69\x6d\x70\x6f\x72\164\141\156\164\73\x6d\x61\x72\x67\151\x6e\55\142\157\x74\164\157\155\x3a" . $so . "\160\x78\x20\x21\x69\155\x70\x6f\162\164\141\x6e\164\73\142\x6f\162\x64\145\x72\x2d\162\x61\x64\x69\165\x73\x3a" . $Ra . "\160\170\x20\41\x69\155\160\x6f\x72\164\x61\156\164\x3b\42\40\143\154\x61\163\x73\75\42\x6f\x61\x75\x74\x68\x6c\x6f\x67\x69\156\x62\165\164\164\157\x6e\x20\x62\164\156\40\142\x74\156\55\163\x6f\x63\x69\141\x6c\x20\142\164\156\x2d\160\162\151\155\x61\x72\171\42\76\40\74\151\x20\163\x74\171\x6c\x65\x3d\42\160\141\x64\144\151\x6e\x67\x2d\x74\x6f\160\x3a" . $e5 . "\x2d\66\x20\160\170\40\41\151\155\x70\157\162\164\141\156\x74\73\x20\x77\x69\x64\x74\150\72\x31\65\x25\42\40\x63\154\141\163\163\75\42\x66\x61\40\x66\x61\x2d\x6c\157\143\x6b\x22\76\x3c\57\151\x3e\40" . $UC . "\40\74\57\x61\76";
        echo $Rb;
        fQ:
    }
    public function mo_oauth_login_form($bX = false, $ok = '')
    {
        global $post;
        $Rb = '';
        $this->error_message();
        $kJ = mo_oauth_client_get_option("\x6d\157\137\157\141\165\164\150\137\147\x6f\157\147\154\x65\x5f\x65\x6e\141\x62\x6c\145") | mo_oauth_client_get_option("\x6d\157\137\x6f\x61\165\164\x68\137\145\166\145\157\156\x6c\x69\156\x65\137\145\156\x61\x62\154\x65") | mo_oauth_client_get_option("\155\x6f\137\157\x61\x75\164\150\x5f\x66\141\143\145\x62\157\x6f\x6b\137\145\x6e\x61\x62\154\x65");
        $so = mo_oauth_client_get_option("\155\x6f\137\x6f\141\165\164\150\x5f\154\x6f\x67\151\x6e\137\151\143\x6f\x6e\137\x73\x70\x61\x63\145");
        $kT = mo_oauth_client_get_option("\x6d\x6f\137\x6f\141\165\164\150\x5f\x6c\x6f\x67\151\x6e\x5f\151\x63\157\156\x5f\143\165\163\164\x6f\x6d\137\167\151\144\164\150");
        $e5 = mo_oauth_client_get_option("\x6d\x6f\x5f\157\141\165\164\x68\x5f\x6c\157\147\x69\x6e\x5f\x69\143\x6f\156\x5f\x63\x75\163\164\157\155\137\x68\x65\x69\147\x68\164");
        $Nc = mo_oauth_client_get_option("\155\x6f\x5f\x6f\141\x75\164\x68\x5f\x6c\157\x67\x69\156\137\x69\143\157\x6e\x5f\x63\x75\163\164\157\155\x5f\163\x69\172\x65");
        $CZ = mo_oauth_client_get_option("\x6d\157\x5f\157\141\x75\x74\x68\x5f\x6c\157\x67\x69\x6e\137\151\143\157\156\137\143\165\x73\164\x6f\x6d\x5f\x63\x6f\154\x6f\x72");
        $Ra = mo_oauth_client_get_option("\x6d\157\137\x6f\x61\x75\164\x68\137\x6c\x6f\147\151\156\x5f\x69\143\157\156\137\143\x75\163\164\x6f\155\x5f\x62\157\x75\x6e\144\x61\162\x79");
        $vQ = mo_oauth_client_get_option("\155\x6f\x5f\x6f\141\x75\164\x68\x5f\141\x70\160\x73\137\x6c\151\163\164");
        if (!($vQ && sizeof($vQ) > 0)) {
            goto bs;
        }
        $kJ = true;
        bs:
        if (!is_user_logged_in()) {
            goto Et;
        }
        $current_user = wp_get_current_user();
        $Ul = "\x48\x6f\167\144\x79\40\x2c\x20\43\x23\165\163\x65\162\x23\x23";
        if (!mo_oauth_client_get_option("\x6d\x6f\x5f\x6f\x61\165\x74\150\x5f\x63\165\163\164\x6f\x6d\x5f\154\157\x67\x6f\165\x74\137\x74\x65\170\164")) {
            goto k_;
        }
        $Ul = mo_oauth_client_get_option("\155\157\x5f\157\x61\x75\x74\x68\x5f\x63\x75\x73\x74\157\155\x5f\154\157\147\157\x75\x74\x5f\x74\x65\170\164");
        k_:
        $Ul = str_replace("\43\43\165\x73\145\162\x23\43", $current_user->display_name, $Ul);
        $uU = __($Ul, "\x66\154\x77");
        $n6 = $_COOKIE["\162\x65\144\151\162\145\143\x74\137\165\162\x6c"];
        $Rb .= $uU . "\174\x3c\x61\40\150\162\x65\x66\x3d\x22" . wp_logout_url($n6) . "\x3b\x22\x20\164\x69\x74\154\x65\x3d\x22" . _e('', "\x66\x6c\x77") . "\x3b\42\x3e\x4c\157\147\x6f\x75\164\74\x2f\x61\x3e";
        goto X3;
        Et:
        if ($kJ) {
            goto Dx;
        }
        $Rb .= "\116\x6f\x20\141\x70\160\163\x20\x63\x6f\156\x66\151\147\x75\162\x65\144\x2e";
        goto SR;
        Dx:
        $this->mo_oauth_load_login_script();
        if (!(mo_oauth_client_get_option("\155\157\x5f\157\141\165\164\150\137\x69\x63\x6f\156\x5f\167\151\x64\x74\x68") != '')) {
            goto kt;
        }
        $kT = mo_oauth_client_get_option("\155\157\137\157\141\165\x74\150\x5f\151\x63\157\x6e\x5f\x77\151\144\x74\x68");
        kt:
        if (!(mo_oauth_client_get_option("\x6d\157\x5f\x6f\141\x75\x74\x68\137\x69\143\157\156\x5f\x68\x65\x69\x67\150\x74") != '')) {
            goto RD;
        }
        $e5 = mo_oauth_client_get_option("\155\157\x5f\157\x61\165\164\150\x5f\x69\143\x6f\156\x5f\150\x65\x69\147\150\x74");
        RD:
        if (!(mo_oauth_client_get_option("\x6d\x6f\x5f\157\141\165\164\150\137\151\x63\x6f\156\137\155\141\162\x67\x69\x6e") != '')) {
            goto BE;
        }
        $so = mo_oauth_client_get_option("\155\x6f\137\157\x61\165\x74\150\137\151\143\157\x6e\x5f\155\x61\162\x67\x69\156");
        BE:
        $jh = mo_oauth_client_get_option("\x6d\x6f\x5f\x6f\x61\x75\164\150\137\151\143\x6f\x6e\137\143\x6f\x6e\146\151\147\165\x72\145\137\x63\x73\163");
        if (!is_array($vQ)) {
            goto eH;
        }
        foreach ($vQ as $OY => $AO) {
            if (!$bX) {
                goto n5;
            }
            if (!($ok !== '')) {
                goto V3;
            }
            if (!($OY !== $ok)) {
                goto YC;
            }
            if (next($vQ)) {
                goto tZ;
            }
            $Rb .= "\x4e\x6f\40\x43\157\156\x66\x69\x67\x75\162\x65\x64\40\x41\160\x70\163\40\167\x69\x74\150\x20\x74\150\x69\x73\40\x6e\141\x6d\x65\x2e";
            tZ:
            goto yj;
            YC:
            V3:
            n5:
            $M4 = mo_oauth_client_get_option("\x6d\157\x5f\157\141\165\x74\x68\x5f\x61\160\x70\137\x6e\x61\x6d\x65\137" . $OY);
            if ($OY == "\105\166\x65\117\156\x6c\x69\156\145\101\x70\x70" || $M4 == "\105\166\x65\117\x6e\x6c\x69\156\145\101\x70\160") {
                goto Rd;
            }
            if ($OY == "\x66\x61\x63\x65\x62\x6f\157\153" || $M4 == "\146\141\143\x65\x62\157\157\x6b") {
                goto KU;
            }
            if ($OY == "\x67\x6f\x6f\147\x6c\x65" || $M4 == "\x67\157\157\147\x6c\x65") {
                goto NZ;
            }
            if ($OY == "\x77\x69\156\144\x6f\x77\163" || $M4 == "\x77\151\x6e\144\157\x77\163") {
                goto Yy;
            }
            if ($OY == "\163\x6c\141\143\153" || $M4 == "\x73\154\x61\143\153") {
                goto Fl;
            }
            if ($OY == "\160\x61\x79\x70\x61\154" || $M4 == "\x70\141\x79\x70\141\x6c") {
                goto PA;
            }
            if ($OY == "\x61\x7a\165\x72\x65" || $M4 == "\141\172\165\162\145") {
                goto gO;
            }
            if ($OY == "\x61\x6d\141\172\x6f\156" || $M4 == "\x61\x6d\x61\x7a\157\x6e") {
                goto N5;
            }
            if ($OY == "\x67\x69\164\x68\165\x62" || $M4 == "\x67\x69\x74\x68\165\x62") {
                goto CK;
            }
            if ($OY == "\x79\x61\150\157\x6f" || $M4 == "\171\x61\x68\157\x6f") {
                goto RT;
            }
            if ($OY == "\146\x69\164\142\151\x74" || $M4 == "\146\151\164\x62\x69\164") {
                goto Lh;
            }
            if ($OY == "\157\160\145\x6e\x69\x64\x63\x6f\156\156\x65\143\164" || $M4 == "\x6f\x70\145\156\x69\x64\143\x6f\x6e\x6e\x65\x63\x74") {
                goto Fp;
            }
            if ($OY == "\142\x69\x74\162\x69\x78\x32\x34" || $M4 == "\142\x69\x74\162\151\170\x32\64") {
                goto r1;
            }
            if ($OY == "\x63\x6c\145\166\145\162" || $M4 == "\x63\154\145\x76\x65\162") {
                goto Pp;
            }
            if ($OY == "\x62\157\170" || $M4 == "\142\x6f\170") {
                goto WN;
            }
            if ($OY == "\143\x6f\147\x6e\151\164\x6f" || $M4 == "\x63\157\x67\x6e\x69\164\x6f") {
                goto pF;
            }
            if ($OY == "\x6f\156\145\154\157\x67\x69\156" || $M4 == "\157\x6e\x6c\157\147\151\x6e") {
                goto VR;
            }
            if ($OY == "\141\144\x66\x73" || $M4 == "\141\144\x66\x73") {
                goto VE;
            }
            if ($OY == "\x67\151\x67\171\x61" || $M4 == "\x67\151\147\171\141") {
                goto e3;
            }
            $lh = '';
            $dX = "\142\164\x6e\x2d\x70\162\151\155\141\x72\x79";
            $dg = "\146\x61\40\146\x61\x2d\154\x6f\x63\153";
            goto Qa;
            Rd:
            $lh = plugins_url("\151\155\141\147\x65\x73\x2f\x69\x63\x6f\156\x73\x2f\x65\x76\x65\x6f\x6e\154\151\156\x65\x2e\x70\x6e\147", __FILE__);
            $dX = "\x62\x74\x6e\55\x67\151\164\x68\165\x62";
            $dg = "\x66\x61\40\146\141\x2d\142\x61\162\x73";
            goto Qa;
            KU:
            $lh = plugins_url("\x69\155\x61\147\x65\163\57\151\x63\157\x6e\x73\57\x66\x61\143\145\x62\157\x6f\x6b\56\160\156\147", __FILE__);
            $dX = "\142\164\x6e\55\x66\141\x63\145\x62\x6f\x6f\153";
            $dg = "\x66\141\x20\x66\x61\x2d\x66\141\143\x65\x62\x6f\157\x6b";
            goto Qa;
            NZ:
            $lh = plugins_url("\x69\155\141\x67\x65\163\57\x69\x63\x6f\156\x73\57\147\x6f\x6f\147\154\x65\56\160\x6e\147", __FILE__);
            $dX = "\x62\x74\x6e\55\147\x6f\x6f\147\x6c\x65";
            $dg = "\x66\141\40\146\141\x2d\147\157\157\x67\154\145\x2d\x70\154\165\163";
            goto Qa;
            Yy:
            $lh = plugins_url("\x69\155\x61\x67\145\x73\57\x69\x63\x6f\x6e\163\57\x77\151\x6e\144\157\167\x73\154\x69\166\x65\x2e\x70\156\x67", __FILE__);
            $dX = "\142\x74\156\55\x6d\x69\143\x72\x6f\163\157\x66\164";
            $dg = "\146\x61\40\146\141\x2d\167\x69\156\144\x6f\167\x73\40";
            goto Qa;
            Fl:
            $lh = plugins_url("\x69\155\x61\x67\x65\163\x2f\151\x63\x6f\156\163\x2f\167\x69\x6e\144\157\167\163\x6c\x69\x76\145\56\x70\x6e\147", __FILE__);
            $dX = "\x62\164\156\x2d\x73\165\143\143\x65\163\163";
            $dg = "\146\141\x20\x66\141\x2d\163\x6c\x61\143\x6b";
            goto Qa;
            PA:
            $lh = plugins_url("\x69\155\x61\x67\145\x73\57\x69\143\157\x6e\x73\57\x77\x69\x6e\x64\157\167\x73\154\x69\166\145\56\x70\x6e\147", __FILE__);
            $dX = "\x62\x74\x6e\55\x70\x72\151\x6d\x61\x72\171";
            $dg = "\x66\141\40\146\x61\55\160\141\171\x70\x61\x6c\40";
            goto Qa;
            gO:
            $lh = plugins_url("\x69\x6d\x61\x67\145\163\57\x69\143\157\x6e\163\x2f\x77\x69\156\144\x6f\167\x73\x6c\x69\x76\145\x2e\160\156\147", __FILE__);
            $dX = "\142\x74\x6e\55\x6d\x69\x63\162\x6f\x73\157\146\164";
            $dg = "\146\141\x20\x66\x61\55\167\151\156\x64\x6f\x77\163\40";
            goto Qa;
            N5:
            $lh = plugins_url("\x69\x6d\x61\x67\x65\163\57\151\143\x6f\156\163\57\167\151\x6e\x64\157\x77\x73\x6c\151\x76\145\56\160\x6e\147", __FILE__);
            $dX = "\142\x74\156\x2d\x6f\x70\x65\x6e\151\144";
            $dg = "\x66\x61\x20\146\x61\x2d\141\x6d\x61\x7a\x6f\156\40";
            goto Qa;
            CK:
            $lh = plugins_url("\151\x6d\x61\x67\x65\x73\57\151\143\157\156\x73\57\x77\x69\156\x64\157\x77\x73\154\x69\x76\145\56\x70\156\x67", __FILE__);
            $dX = "\142\164\x6e\x2d\147\x69\164\150\165\x62";
            $dg = "\x66\141\x20\x66\x61\55\x67\x69\164\x68\165\x62\x20";
            goto Qa;
            RT:
            $lh = plugins_url("\x69\155\141\x67\x65\163\x2f\x69\x63\157\x6e\x73\57\x77\151\x6e\144\157\x77\x73\154\151\166\145\x2e\160\x6e\147", __FILE__);
            $dX = "\x62\x74\156\55\171\141\150\x6f\x6f";
            $dg = "\x66\141\40\x66\x61\x2d\x79\141\150\x6f\157\x20";
            goto Qa;
            Lh:
            $lh = plugins_url("\151\155\141\x67\145\x73\x2f\151\143\x6f\156\x73\x2f\x77\x69\x6e\144\157\167\163\154\x69\x76\145\x2e\x70\x6e\x67", __FILE__);
            $dX = "\x62\x74\156\x2d\166\x6b";
            $dg = "\146\141\x20\x66\x61\x2d\154\157\143\153\x20";
            goto Qa;
            Fp:
            $lh = plugins_url("\x69\155\x61\147\145\x73\57\151\143\157\156\163\x2f\x77\x69\x6e\144\157\167\163\x6c\x69\x76\145\56\x70\x6e\147", __FILE__);
            $dX = "\142\x74\x6e\x2d\157\x70\145\x6e\x69\x64";
            $dg = "\x66\141\40\146\141\x2d\157\x70\x65\x6e\151\x64\40";
            goto Qa;
            r1:
            $lh = plugins_url("\151\155\x61\147\145\163\57\x69\x63\157\156\163\57\x77\x69\x6e\144\x6f\167\x73\x6c\x69\x76\x65\x2e\160\156\x67", __FILE__);
            $dX = "\x62\164\156\55\151\156\146\157";
            $dg = "\x66\141\x20\x66\x61\x2d\143\x6c\157\143\x6b\x2d\157";
            goto Qa;
            Pp:
            $lh = plugins_url("\151\x6d\x61\x67\145\x73\x2f\151\143\x6f\x6e\x73\x2f\167\x69\156\x64\157\167\163\154\151\166\145\x2e\x70\x6e\x67", __FILE__);
            $dX = "\x62\x74\156\55\146\x61\143\x65\142\x6f\157\153";
            $dg = "\x66\141\x20\146\141\55\x6c\x6f\x63\153\x20";
            goto Qa;
            WN:
            $lh = plugins_url("\151\x6d\x61\x67\x65\163\x2f\151\143\x6f\156\163\57\x77\151\x6e\144\x6f\x77\x73\x6c\x69\166\145\x2e\x70\x6e\x67", __FILE__);
            $dX = "\x62\164\156\x2d\160\x72\151\x6d\141\162\x79";
            $dg = "\x66\141\x20\146\x61\55\x6c\x6f\143\x6b";
            goto Qa;
            pF:
            $lh = plugins_url("\x69\x6d\141\x67\x65\x73\57\x69\x63\x6f\156\x73\57\x77\151\x6e\144\x6f\167\163\x6c\151\x76\x65\56\x70\156\147", __FILE__);
            $dX = "\x62\x74\156\x2d\157\x70\145\156\151\144";
            $dg = "\x66\x61\40\146\x61\x2d\141\x6d\141\x7a\157\156";
            goto Qa;
            VR:
            $lh = plugins_url("\151\155\141\x67\145\163\x2f\x69\143\x6f\x6e\x73\57\x77\151\x6e\144\157\167\163\x6c\151\166\145\56\x70\x6e\147", __FILE__);
            $dX = "\x62\x74\156\55\x67\151\x74\x68\x75\x62";
            $dg = "\x66\141\40\146\141\55\154\x6f\x63\153";
            goto Qa;
            VE:
            $lh = plugins_url("\x69\x6d\141\147\145\163\57\151\x63\157\x6e\x73\x2f\167\x69\x6e\144\157\167\x73\x6c\x69\x76\x65\56\x70\x6e\147", __FILE__);
            $dX = "\x62\164\x6e\55\x6d\151\x63\x72\x6f\163\157\146\164";
            $dg = "\x66\141\x20\146\x61\55\x77\151\156\144\x6f\x77\x73";
            goto Qa;
            e3:
            $lh = plugins_url("\x69\155\141\147\145\163\x2f\151\143\x6f\x6e\x73\57\167\x69\x6e\x64\x6f\167\163\154\x69\166\145\x2e\160\x6e\147", __FILE__);
            $dX = "\142\x74\x6e\x2d\x70\x72\151\x6d\141\x72\171";
            $dg = "\146\x61\x20\x66\x61\x2d\x6c\157\x63\x6b";
            Qa:
            $Oz = "\x6f\x61\x75\x74\150\x5f\141\160\160\137" . str_replace("\x20", "\55", $OY);
            if (array_key_exists("\x64\x69\163\160\x6c\x61\171\141\160\x70\x6e\x61\x6d\145", $AO) && !empty($AO["\x64\x69\163\x70\154\141\171\x61\x70\x70\156\x61\155\x65"])) {
                goto pE;
            }
            $ge = ucwords($OY);
            goto hj;
            pE:
            $ge = $AO["\144\x69\163\160\x6c\x61\171\141\160\160\156\141\x6d\x65"];
            hj:
            if (empty($jh)) {
                goto AG;
            }
            $Rb .= "\x3c\x61\40\x68\x72\145\146\x3d\42\152\x61\166\141\163\143\162\x69\160\x74\x3a\x76\157\x69\x64\50\60\51\42\x20\x6f\x6e\x63\154\151\143\153\x3d\x22\x6d\157\x4f\101\x75\164\x68\x4c\157\147\151\156\116\x65\x77\x28\47" . $OY . "\x27\x29\73\x22\x20\143\154\141\163\x73\75\x22\157\141\x75\x74\x68\154\157\x67\x69\156\142\165\164\x74\x6f\156\x20\142\x74\x6e\40\x62\x74\x6e\55\163\x6f\143\151\141\154\x22\76\40\x3c\x69\x20\x63\x6c\x61\x73\163\x3d\x22" . $dg . "\40\143\x75\x73\164\x6f\155\x5f\x6c\157\147\x6f\42\x3e\x3c\57\x69\76\40" . $ge . "\40\74\57\141\x3e";
            $Rb .= "\x3c\x73\x74\171\154\145\76" . $jh . "\74\57\x73\164\x79\154\x65\76";
            goto om;
            AG:
            $Rb .= "\74\x61\40\150\x72\145\x66\75\42\152\x61\x76\141\163\x63\162\x69\160\x74\72\x76\157\x69\x64\x28\60\51\42\x20\x6f\156\x63\154\151\x63\x6b\x3d\42\155\157\117\x41\165\x74\150\x4c\157\147\151\x6e\116\145\167\x28\x27" . $OY . "\47\51\x3b\x22\x20\x73\164\x79\154\x65\x3d\42\143\x6f\154\x6f\x72\72\167\x68\x69\164\x65\x3b\x20\167\151\x64\164\150\72" . $kT . "\160\170\x20\41\151\155\160\x6f\162\164\141\156\x74\x3b\160\141\x64\144\151\x6e\147\x2d\x74\157\160\72" . $e5 . "\160\170\x20\41\x69\155\x70\x6f\162\x74\x61\156\164\x3b\x70\x61\144\x64\x69\x6e\x67\x2d\x62\157\164\x74\157\155\x3a" . $e5 . "\160\x78\40\x21\151\x6d\x70\157\x72\164\x61\156\164\x3b\155\x61\x72\147\151\x6e\55\142\x6f\x74\164\x6f\x6d\72" . $so . "\160\170\x20\41\151\155\160\157\x72\164\x61\156\164\x3b\142\x6f\162\x64\145\162\55\162\x61\144\151\x75\163\x3a" . $Ra . "\x70\x78\x20\41\151\155\160\x6f\x72\164\141\x6e\x74\73\x22\x20\x63\x6c\x61\x73\x73\75\42\157\x61\165\x74\x68\x6c\157\x67\x69\x6e\142\165\164\x74\157\156\40\x62\x74\156\x20\x62\164\x6e\x2d\163\x6f\143\x69\x61\x6c\40" . $dX . "\x22\76\x20\x3c\151\x20\x73\x74\171\154\x65\75\42\x70\x61\x64\144\x69\x6e\147\55\164\x6f\x70\72" . $e5 . "\55\66\40\x70\x78\40\41\151\x6d\x70\x6f\162\164\x61\156\164\x3b\40\167\151\144\x74\150\x3a\x31\x35\45\42\x20\143\154\x61\x73\x73\75\42" . $dg . "\x22\x3e\74\57\x69\x3e\40" . $ge . "\40\74\x2f\141\76";
            om:
            $M4 = "\40";
            yj:
        }
        rA:
        eH:
        SR:
        X3:
        return $Rb;
    }
    private function mo_oauth_load_login_script()
    {
        ?>
	<script type="text/javascript">

		function HandlePopupResult(result) {
			window.location.href = result;
		}

		function moOAuthLogin(app_name) {
			window.location.href = '<?php 
        echo site_url();
        ?>
' + '/?option=generateDynmicUrl&app_name=' + app_name;
		}



		function moOAuthCommonLogin(app_name) {
			<?php 
        $DL = (isset($_SERVER["\x48\124\x54\120\123"]) ? "\150\164\x74\x70\163" : "\150\164\164\160") . "\x3a\57\57{$_SERVER["\x48\124\x54\120\x5f\110\x4f\x53\x54"]}{$_SERVER["\x52\x45\121\x55\x45\123\124\137\125\x52\x49"]}";
        wp_cache_set("\x6f\x61\x75\164\150\137\x72\x65\x70\x6c\141\171\x73\x74\141\x74\145", $DL, "\155\x6f\137\x6f\x61\x75\x74\150\137\x63\x6c\151\145\x6e\x74\x5f\160\162\x65\155\x69\x75\155");
        $xH = '';
        $vQ = mo_oauth_client_get_option("\155\157\137\157\x61\x75\164\x68\x5f\141\x70\x70\163\x5f\154\151\x73\x74");
        if (!is_array($vQ)) {
            goto js;
        }
        foreach ($vQ as $OY => $O2) {
            $xH .= "\x3c\141\40\x68\x72\145\146\75\42" . site_url() . "\57\77\x6f\x70\x74\x69\157\156\x3d\x6f\x61\165\164\150\x72\x65\x64\x69\162\145\143\x74\46\141\160\160\x5f\x6e\141\x6d\145\x3d" . $OY . "\42\76" . $OY . "\x3c\x2f\x61\x3e\x26\x6e\x62\x73\x70\x3b\x26\x6e\142\x73\x70\73";
            aC:
        }
        qt:
        js:
        echo "\157\165\164\160\x75\x74\40\75\40\x27\x3c\142\x3e\x50\154\145\141\163\145\40\163\x65\x6c\x65\x63\x74\x20\x79\x6f\x75\162\x20\x47\162\x6f\x75\160\x2f\114\x6f\x67\151\x6e\x20\x44\157\x6d\141\x69\156\40\x3a\40\74\57\x62\76\74\142\162\x3e\74\142\x72\76" . $xH . "\47\73";
        echo "\x64\x6f\143\165\155\x65\156\164\56\167\162\151\164\145\50\x6f\x75\x74\160\165\164\51\73";
        ?>
		}



		function moOAuthLoginNew(app_name) {
			<?php 
        $DL = (isset($_SERVER["\x48\x54\x54\120\x53"]) ? "\x68\164\164\x70\163" : "\150\164\164\x70") . "\x3a\x2f\x2f{$_SERVER["\110\x54\124\x50\x5f\x48\117\123\124"]}{$_SERVER["\122\105\121\125\x45\123\x54\x5f\125\x52\x49"]}";
        ?>
			var redirect_uri="<?php 
        echo $DL;
        ?>
";
			// if(app_name=='eveonline'){
			// 	window.location.href = '<?php 
        echo site_url();
        ?>
' + '/?option=generateDynmicUrl&app_name=' + app_name;
			// } else { 			
				<?php 
        wp_cache_set("\157\x61\165\164\150\137\162\x65\160\154\141\171\x73\164\141\x74\145", $DL, "\x6d\157\x5f\x6f\x61\x75\x74\x68\137\x63\x6c\151\x65\x6e\164\x5f\x70\x72\145\x6d\151\x75\155");
        if (mo_oauth_client_get_option("\155\157\137\157\x61\x75\x74\150\137\143\x6c\151\145\156\x74\x5f\x70\157\x70\165\x70\137\x6c\x6f\147\x69\x6e")) {
            goto pl;
        }
        echo "\x77\151\x6e\144\157\x77\x2e\x6c\157\143\x61\x74\151\157\156\56\150\162\x65\146\40\x3d\40\47" . site_url() . "\x27\x20\53\x20\47\57\77\x6f\x70\164\151\157\x6e\x3d\x6f\141\165\x74\x68\x72\x65\144\x69\x72\145\x63\164\x26\141\160\160\137\x6e\141\155\145\75\47\x20\x2b\40\x61\160\160\137\x6e\x61\155\x65\x2b\40\47\x26\162\145\144\151\x72\145\143\x74\x5f\x75\162\154\75\47\x2b\40\162\x65\144\x69\162\145\143\x74\137\165\162\x69\x3b";
        goto MR;
        pl:
        echo "\x76\x61\x72\40\155\x79\127\x69\156\144\x6f\x77\x20\75\x20\167\151\156\x64\157\x77\x2e\x6f\160\x65\156\50\x27" . site_url() . "\x27\40\x2b\x20\x27\57\77\x6f\160\164\x69\x6f\x6e\75\x6f\141\x75\x74\150\162\x65\x64\x69\x72\145\x63\x74\46\x61\160\160\137\x6e\x61\x6d\145\75\47\40\x2b\x20\x61\160\160\x5f\x6e\x61\155\x65\x20\x2b\x20\47\46\x72\145\x64\151\162\145\x63\x74\x5f\165\x72\x6c\75\47\x20\x2b\x20\x72\145\x64\x69\x72\145\143\164\137\165\x72\x69\54\40\x27\x27\x2c\40\x27\167\151\144\x74\x68\75\x35\60\60\54\x68\x65\x69\147\150\x74\x3d\65\60\60\47\x29\73";
        MR:
        ?>
			<!-- } -->

		}
	</script>
	<?php 
    }
    public function error_message()
    {
        $tT = wp_cache_get("\x6d\163\147", "\155\157\137\x6f\141\165\164\150\x5f\x63\154\x69\145\156\164\137\160\162\145\x6d\151\x75\x6d");
        $MP = wp_cache_get("\155\163\147\137\143\154\141\x73\x73", "\x6d\x6f\x5f\157\x61\x75\x74\150\x5f\x63\154\151\145\x6e\164\137\160\x72\145\155\x69\x75\x6d");
        if (!($tT && $MP)) {
            goto FR;
        }
        echo "\74\x64\x69\x76\x20\x63\154\x61\163\163\x3d\42" . $MP . "\x22\76" . $tT . "\74\57\144\151\166\x3e";
        wp_cache_delete("\x6d\x73\147", "\x6d\x6f\x5f\157\x61\x75\x74\150\137\143\154\x69\145\156\x74\137\x70\162\x65\155\x69\x75\x6d");
        wp_cache_delete("\x6d\x73\147\137\x63\154\141\163\x73", "\x6d\157\x5f\157\141\165\x74\150\x5f\143\154\x69\x65\x6e\164\137\160\x72\145\x6d\151\x75\x6d");
        FR:
    }
    public function register_plugin_styles()
    {
    }
}
function mo_oauth_login_validate()
{
    if (isset($_REQUEST["\x6f\160\164\151\157\156"]) and strpos($_REQUEST["\157\x70\164\151\157\x6e"], "\157\x61\x75\x74\x68\162\x65\x64\x69\162\145\143\x74") !== false) {
        goto n9;
    }
    if (isset($_REQUEST["\143\157\144\145"]) && isset($_REQUEST["\163\164\x61\x74\x65"])) {
        goto y_;
    }
    if (isset($_REQUEST["\x6f\160\164\151\157\x6e"]) and strpos($_REQUEST["\157\x70\x74\x69\x6f\156"], "\147\x65\156\145\162\x61\x74\145\x44\171\x6e\155\151\x63\125\x72\154") !== false) {
        goto IN;
    }
    if (isset($_REQUEST["\x6f\x70\164\151\x6f\156"]) and strpos($_REQUEST["\x6f\160\164\151\157\156"], "\x6d\157\157\x61\x75\x74\x68") !== false) {
        goto Fo;
    }
    if (isset($_REQUEST["\x74\157\x6b\145\156"]) && !empty($_REQUEST["\x74\157\x6b\145\156"])) {
        goto gl;
    }
    if (isset($_REQUEST["\x69\144\x5f\x74\x6f\153\145\156"]) && !empty($_REQUEST["\x69\x64\x5f\164\x6f\153\145\x6e"])) {
        goto Au;
    }
    if (!(isset($_REQUEST["\141\x63\143\145\163\x73\137\x74\157\153\x65\156"]) && !empty($_REQUEST["\x61\143\x63\x65\163\163\x5f\164\157\x6b\x65\156"]))) {
        goto nv;
    }
    if (!isset($_REQUEST["\x73\x74\141\164\x65"])) {
        goto Ce;
    }
    $If = $_REQUEST["\x61\143\143\x65\x73\163\137\x74\x6f\153\x65\x6e"];
    $eC = $_REQUEST["\x73\x74\x61\x74\145"];
    $Yd = base64_decode(explode("\x5f", $eC)[1]);
    $Yd = explode("\73", $Yd);
    $rL = $Yd[0];
    $n6 = isset($Yd[1]) ? $Yd[1] : site_url();
    if (!is_jwt($If, "\56")) {
        goto Rz;
    }
    $QB = handleJWT($If, false, $n6);
    Rz:
    $vQ = mo_oauth_client_get_option("\155\157\137\x6f\x61\165\x74\x68\x5f\x61\160\160\x73\137\154\x69\x73\x74");
    $Qu = $ie = $Xo = $p0 = $nY = $b3 = '';
    $X6 = false;
    foreach ($vQ as $OY => $AO) {
        if (!($OY == $rL)) {
            goto nA;
        }
        $X6 = $AO;
        nA:
        C2:
    }
    gC:
    if ($X6) {
        goto y5;
    }
    die("\101\x70\x70\x6c\x69\x63\x61\x74\151\157\x6e\40\156\x6f\164\40\143\157\x6e\x66\151\x67\x75\x72\145\x64\x2e");
    y5:
    $L0 = new Mo_OAuth_Hanlder();
    $Y3 = array();
    $h8 = isset($X6["\162\145\163\157\165\x72\143\x65\157\167\x6e\x65\162\x64\x65\164\x61\151\154\163\165\x72\x6c"]) ? $X6["\162\x65\163\x6f\x75\x72\143\145\x6f\x77\156\x65\x72\x64\x65\164\141\151\154\163\x75\162\154"] : '';
    if (!(substr($h8, -1) == "\x3d")) {
        goto YJ;
    }
    $h8 .= $If;
    YJ:
    $Y3 = array();
    if (empty($h8)) {
        goto Wx;
    }
    $Y3 = $L0->getResourceOwner($h8, $If);
    Wx:
    $qJ = isset($X6["\147\162\x6f\x75\x70\144\145\x74\x61\x69\x6c\163\165\162\x6c"]) ? $X6["\147\162\157\x75\x70\x64\145\x74\x61\x69\154\163\x75\162\x6c"] : '';
    $Np = array();
    if (!(substr($qJ, -1) == "\75")) {
        goto eS;
    }
    $qJ .= $If;
    eS:
    if (empty($qJ)) {
        goto m5;
    }
    $Np = $L0->getResourceOwner($qJ, $If);
    m5:
    if (!(isset($QB) && is_array($QB))) {
        goto wZ;
    }
    $Y3 = array_merge($QB, $Y3);
    wZ:
    mo_oauth_client_handle_sso($rL, $X6, $Y3, $Np, array("\x61\x63\x63\145\x73\163\x5f\164\157\153\145\156" => $If), $n6);
    Ce:
    nv:
    goto Bg;
    Au:
    $wu = $_REQUEST["\x69\x64\x5f\164\x6f\153\x65\x6e"];
    $eC = $_REQUEST["\163\x74\x61\x74\145"];
    $Yd = base64_decode(explode("\x5f", $eC)[1]);
    $Yd = explode("\73", $Yd);
    $rL = $Yd[0];
    $n6 = isset($Yd[1]) ? $Yd[1] : site_url();
    handleJWT($wu, true, $n6);
    Bg:
    goto ZJ;
    gl:
    $wu = $_REQUEST["\164\x6f\x6b\145\156"];
    $eC = $_REQUEST["\x73\x74\141\x74\145"];
    $Yd = base64_decode(explode("\137", $eC)[1]);
    $Yd = explode("\73", $Yd);
    $rL = $Yd[0];
    $n6 = isset($Yd[1]) ? $Yd[1] : site_url();
    handleJWT($wu, true, $n6);
    ZJ:
    goto nM;
    Fo:
    $If = $_POST["\x61\x63\x63\145\x73\163\137\x74\x6f\x6b\x65\156"];
    $vF = $_POST["\164\157\153\145\x6e\x5f\164\x79\160\145"];
    $cm = '';
    if (!array_key_exists("\x65\155\x61\x69\154", $_POST)) {
        goto em;
    }
    $cm = $_POST["\x65\x6d\141\x69\154"];
    em:
    if ($_POST["\103\x68\141\162\141\x63\164\145\x72\111\x44"]) {
        goto z2;
    }
    if (!$cm) {
        goto t5;
    }
    if (email_exists($cm)) {
        goto fY;
    }
    $GC = wp_generate_password(10, false);
    $oO = wp_create_user($cm, $GC, $cm);
    wp_set_auth_cookie($oO, true);
    goto xj;
    fY:
    $user = get_user_by("\145\155\x61\151\x6c", $cm);
    $oO = $user->ID;
    wp_set_auth_cookie($oO, true);
    xj:
    t5:
    goto IO;
    z2:
    wp_cache_set("\143\x68\x61\x72\x61\143\164\145\x72\137\151\x64", $_POST["\103\150\x61\x72\x61\x63\x74\145\162\x49\104"], "\x6d\157\x5f\157\141\x75\x74\x68\137\143\154\x69\x65\156\x74\137\160\162\145\155\151\x75\x6d");
    wp_cache_set("\x63\150\141\x72\x61\143\x74\x65\x72\x5f\x6e\x61\x6d\145", $_POST["\x43\150\141\162\141\x63\x74\145\162\x4e\141\x6d\145"], "\x6d\157\137\x6f\x61\165\x74\150\x5f\143\154\151\x65\156\x74\x5f\160\x72\145\x6d\x69\165\x6d");
    Config::getInstance()->access = new \Pheal\Access\StaticCheck();
    $Z9 = mo_oauth_client_get_option("\x6d\x6f\x5f\145\x76\145\137\141\x70\x69\137\x6b\x65\171");
    $M0 = mo_oauth_client_get_option("\155\x6f\x5f\x65\x76\x65\x5f\x76\x65\162\151\146\151\143\x61\x74\151\x6f\156\x5f\143\157\x64\x65");
    if ($Z9 && $M0) {
        goto J6;
    }
    $G8 = wp_cache_get("\143\x68\141\162\141\143\164\145\162\137\151\144", "\155\x6f\x5f\x6f\141\165\x74\150\137\143\x6c\x69\145\156\x74\x5f\x70\162\x65\x6d\151\165\x6d");
    $kG = wp_cache_get("\143\150\141\x72\141\x63\x74\145\162\137\x6e\141\x6d\145", "\x6d\x6f\137\157\141\x75\x74\x68\x5f\143\154\151\x65\x6e\x74\137\x70\162\x65\x6d\x69\x75\155");
    $Xd = $G8 . "\x2e\x65\x76\x65\157\x6e\154\x69\156\145\100\x77\x6f\162\x64\160\x72\x65\163\x73\56\x63\x6f\x6d";
    if ($G8 !== false && username_exists($G8)) {
        goto VX;
    }
    $GC = wp_generate_password(10, false);
    $xJ = array("\x75\x73\145\162\137\154\x6f\147\x69\x6e" => $G8, "\x75\163\x65\x72\137\145\155\141\151\154" => $Xd, "\165\x73\145\162\x5f\160\x61\163\x73" => $GC, "\x64\151\x73\160\154\141\171\137\156\x61\x6d\x65" => $kG !== false ? $kG : '', "\x6c\x61\x73\x74\x5f\156\x61\x6d\145" => $kG !== false ? $kG : '');
    $oO = wp_insert_user($xJ);
    update_user_meta($oO, "\x75\163\x65\x72\x5f\145\x76\145\x6f\x6e\x6c\151\156\145\137\143\150\141\x72\x61\143\164\145\x72\x5f\156\141\155\x65", $kG !== false ? $kG : '');
    set_avatar($oO, $G8);
    wp_set_auth_cookie($oO, true);
    goto N_;
    VX:
    $user = get_user_by("\x6c\x6f\147\x69\156", $G8);
    $oO = $user->ID;
    update_user_meta($oO, "\x75\163\x65\x72\137\145\166\145\157\156\154\151\156\145\x5f\143\150\x61\162\141\x63\x74\145\162\137\156\x61\x6d\145", $kG !== false ? $kG : '');
    set_avatar($oO, $G8);
    wp_set_auth_cookie($oO, true);
    N_:
    goto mJ;
    J6:
    $hb = new Pheal($Z9, $M0, "\145\x76\x65");
    try {
        $x5 = wp_cache_get("\143\150\x61\162\x61\143\164\145\162\137\151\x64", "\x6d\157\137\x6f\x61\x75\x74\150\137\x63\154\x69\x65\x6e\164\137\x70\x72\145\155\x69\x75\x6d");
        $Dx = $hb->CharacterInfo(array("\143\x68\x61\x72\x61\143\x74\145\162\111\104" => $x5));
        wp_cache_set("\143\157\162\160\x6f\x72\x61\x74\151\157\x6e\137\x6e\x61\x6d\x65", $Dx->corporation, "\155\x6f\137\157\141\165\x74\150\x5f\x63\x6c\151\145\x6e\164\x5f\x70\162\x65\155\151\x75\x6d");
        wp_cache_set("\141\x6c\154\x69\x61\156\143\x65\x5f\156\x61\155\x65", $Dx->alliance, "\x6d\x6f\137\x6f\x61\165\164\150\137\143\154\151\x65\156\x74\x5f\x70\162\145\155\151\165\155");
    } catch (\Pheal\Exceptions\PhealException $C_) {
    }
    $LD = mo_oauth_client_get_option("\x6d\157\137\x65\x76\145\x5f\141\154\x6c\157\x77\145\x64\x5f\x63\x6f\x72\160\x73") ? mo_oauth_client_get_option("\x6d\157\137\145\x76\145\137\141\154\154\x6f\x77\145\144\137\x63\x6f\x72\x70\x73") : false;
    $Dv = mo_oauth_client_get_option("\x6d\157\137\145\x76\x65\x5f\141\x6c\154\x6f\x77\x65\x64\137\x61\154\154\151\141\x6e\x63\x65\x73") ? mo_oauth_client_get_option("\155\x6f\x5f\145\166\145\137\x61\154\154\x6f\x77\x65\x64\x5f\141\x6c\154\x69\141\x6e\x63\145\163") : false;
    $Lv = mo_oauth_client_get_option("\155\x6f\x5f\x65\x76\145\x5f\x61\x6c\154\x6f\x77\145\x64\137\143\x68\141\x72\x5f\156\x61\155\145") ? mo_oauth_client_get_option("\155\157\137\x65\166\145\x5f\141\154\x6c\x6f\x77\x65\x64\x5f\143\150\141\x72\x5f\156\141\x6d\145") : false;
    $bn = false;
    if (!$LD && !$Dv && !$Lv) {
        goto eq;
    }
    $kg = wp_cache_get("\143\x6f\x72\x70\157\x72\x61\x74\x69\x6f\156\x5f\156\141\x6d\x65", "\155\x6f\x5f\x6f\141\165\x74\150\x5f\143\x6c\151\x65\156\164\x5f\160\162\x65\155\x69\165\155");
    $cY = wp_cache_get("\141\154\154\x69\141\156\143\145\137\x6e\x61\x6d\x65", "\155\157\x5f\x6f\141\165\164\x68\x5f\143\154\x69\x65\156\164\x5f\x70\x72\145\x6d\151\x75\155");
    $kG = wp_cache_get("\143\150\141\x72\x61\x63\164\x65\x72\137\x6e\141\x6d\145", "\155\157\137\157\141\x75\164\x68\x5f\143\154\151\x65\156\x74\x5f\160\162\145\x6d\x69\x75\155");
    if ($kg !== false) {
        goto Zj;
    }
    $vM = '';
    goto Ua;
    Zj:
    $vM = mo_oauth_check_validity_of_entity(mo_oauth_client_get_option("\155\157\137\145\x76\145\x5f\x61\x6c\154\157\167\x65\144\137\x63\157\162\160\163"), $kg, "\143\157\162\x70\157\162\x61\x74\x69\x6f\156\137\156\141\x6d\x65");
    Ua:
    if ($cY !== false) {
        goto A8;
    }
    $Qp = '';
    goto UA;
    A8:
    $Qp = mo_oauth_check_validity_of_entity(mo_oauth_client_get_option("\x6d\157\137\145\x76\145\x5f\x61\154\x6c\157\167\145\x64\x5f\141\x6c\x6c\151\x61\156\x63\145\163"), $cY, "\141\x6c\x6c\151\141\156\143\145\137\156\x61\155\145");
    UA:
    if ($kG !== false) {
        goto Wy;
    }
    $kG = '';
    goto yd;
    Wy:
    $FB = mo_oauth_check_validity_of_entity(mo_oauth_client_get_option("\x6d\157\137\x65\166\145\x5f\141\154\154\x6f\x77\145\144\137\x63\150\141\x72\x5f\x6e\141\x6d\145"), $kG, "\143\150\141\x72\141\x63\x74\x65\x72\x5f\x6e\x61\155\x65");
    yd:
    $bn = $vM || $Qp || $FB;
    goto i6;
    eq:
    $bn = true;
    i6:
    if ($bn) {
        goto wa;
    }
    error_reporting(0);
    ?>
						<table>

								<div class="rectangle" style="width:700px; height:180px;  margin:5% auto;">
								<h1 style="text-align:center">Access Denied!</h1>
								<div style="font-size:22px; color:#222;padding:20px;text-align:center;background:#F1F1F1;border:1.5px solid grey;  box-shadow: 10px 10px 5px grey;">It seems that either of your Corporation, Alliance or Character Name is not allowed to access this site.<br><br>
								Please contact site Administrator to get access.<br></div>
								</div>

						</table>
						<?php 
    die;
    goto vF;
    wa:
    $G8 = wp_cache_get("\x63\x68\141\162\x61\x63\x74\x65\162\137\x69\x64", "\155\157\x5f\x6f\x61\x75\x74\x68\x5f\143\154\x69\x65\156\x74\137\x70\162\145\155\x69\x75\155");
    $Xd = $G8 . "\56\x65\x76\x65\157\x6e\x6c\151\x6e\x65\100\x77\x6f\x72\x64\x70\162\x65\163\163\x2e\143\157\155";
    $Vw = true;
    if ($G8 !== false && username_exists($G8)) {
        goto n1;
    }
    $GC = wp_generate_password(10, false);
    $kG = wp_cache_get("\x63\150\141\162\x61\143\x74\145\162\137\x6e\x61\x6d\x65", "\155\x6f\x5f\157\141\x75\164\150\x5f\143\154\151\x65\x6e\164\x5f\160\162\145\x6d\151\x75\x6d");
    $xJ = array("\165\x73\x65\162\x5f\x6c\157\147\x69\x6e" => $G8, "\165\163\145\x72\x5f\145\155\x61\151\154" => $Xd, "\165\163\x65\x72\137\160\x61\163\163" => $GC, "\144\x69\163\x70\154\x61\x79\137\156\x61\x6d\145" => $kG !== false ? $kG : '', "\154\141\x73\x74\x5f\156\x61\x6d\145" => $kG !== false ? $kG : '');
    $oO = wp_insert_user($xJ);
    goto gL;
    n1:
    $user = get_user_by("\154\157\147\151\156", $G8);
    $oO = $user->ID;
    $Vw = false;
    gL:
    $kg = wp_cache_get("\143\157\x72\x70\157\x72\x61\x74\151\x6f\156\x5f\x6e\x61\155\x65", "\x6d\157\137\157\x61\x75\x74\150\x5f\143\x6c\151\145\x6e\164\137\x70\162\145\x6d\151\165\x6d");
    $cY = wp_cache_get("\141\x6c\154\151\141\x6e\x63\145\137\156\x61\155\145", "\x6d\157\137\157\141\165\x74\150\x5f\x63\x6c\x69\x65\156\164\137\x70\162\x65\155\x69\x75\155");
    $kG = wp_cache_get("\x63\x68\141\x72\x61\143\164\x65\x72\137\x6e\141\x6d\145", "\155\x6f\x5f\x6f\141\x75\x74\x68\137\x63\x6c\x69\145\156\x74\137\x70\162\x65\155\x69\x75\155");
    update_user_meta($oO, "\x75\x73\145\162\137\x65\x76\x65\157\156\x6c\151\x6e\x65\137\143\x6f\162\160\x6f\162\x61\164\151\157\156\137\x6e\141\x6d\145", $kg !== false ? $kg : '');
    update_user_meta($oO, "\x75\163\x65\x72\x5f\145\166\x65\x6f\156\154\151\x6e\145\x5f\141\x6c\154\x69\141\x6e\143\145\x5f\x6e\x61\155\145", $cY !== false ? $cY : '');
    update_user_meta($oO, "\165\x73\x65\x72\137\x65\x76\145\157\156\154\151\156\x65\137\x63\x68\x61\x72\141\143\x74\x65\x72\137\x6e\x61\155\x65", $kG !== false ? $kG : '');
    set_avatar($oO, $G8);
    if (!($kg !== false)) {
        goto vQ;
    }
    $C5 = new Mo_OAuth_Client_Role_Mapping();
    $C5->apply($oO, "\145\x76\x65\157\156\154\x69\156\x65", $kg, $Vw);
    vQ:
    wp_set_auth_cookie($oO, true);
    vF:
    mJ:
    IO:
    wp_redirect(home_url());
    die;
    nM:
    goto nS;
    IN:
    $Yr = mo_oauth_client_get_option("\155\157\137\x6f\x61\x75\x74\x68\x5f" . $_REQUEST["\x61\160\160\137\x6e\141\155\145"] . "\x5f\143\154\x69\145\156\x74\x5f\151\x64");
    $lH = round(microtime(true) * 1000);
    $nU = mo_oauth_client_get_option("\155\x6f\137\x6f\x61\165\x74\150\137\141\x64\x6d\151\156\x5f\x61\160\151\x5f\153\x65\171");
    $kl = $Yr . "\72" . number_format($lH, 0, '', '') . "\72" . $nU;
    $J7 = mo_oauth_client_get_option("\143\x75\163\164\157\155\145\162\x5f\164\157\153\145\156");
    $jd = "\101\x45\123\55\61\x32\x38\x2d\105\x43\102";
    $jg = openssl_cipher_iv_length($jd);
    $YK = openssl_random_pseudo_bytes($jg);
    $Gs = openssl_encrypt($kl, $jd, $J7, OPENSSL_RAW_DATA || OPENSSL_ZERO_PADDING, $YK);
    $Cy = base64_encode($YK . $Gs);
    $Pw = urlencode($Cy);
    $Va = urlencode(site_url() . "\x2f\77\x6f\160\x74\151\157\x6e\75\x6d\x6f\x6f\x61\x75\x74\x68");
    $qV = mo_oauth_client_get_option("\150\x6f\163\164\x5f\x6e\x61\x6d\145") . "\x2f\155\157\x61\163\x2f\x6f\141\165\164\150\57\143\154\x69\x65\x6e\164\57\x61\165\x74\150\157\162\x69\172\145\x3f\x74\x6f\153\145\156\75" . $Pw . "\46\151\144\x3d" . mo_oauth_client_get_option("\155\x6f\x5f\157\141\165\164\x68\137\141\x64\x6d\151\x6e\x5f\x63\165\x73\164\157\x6d\x65\x72\137\153\x65\171") . "\46\145\156\x63\x72\171\160\x74\145\x64\75\164\162\165\x65\x26\141\x70\160\75" . $_REQUEST["\x61\160\x70\137\x6e\x61\155\145"] . "\x5f\x6f\x61\x75\x74\x68\x26\x72\145\164\165\x72\x6e\165\162\x6c\x3d" . $Va;
    wp_redirect($qV);
    die;
    nS:
    goto rb;
    y_:
    if (!(session_id() == '' || !isset($_SESSION))) {
        goto bn;
    }
    session_start();
    bn:
    if (!isset($_GET["\143\x6f\x64\x65"])) {
        goto kc;
    }
    try {
        $rL = '';
        $Rb = wp_cache_get("\141\x70\160\x6e\x61\155\x65", "\x6d\x6f\x5f\157\141\165\164\150\x5f\143\154\151\x65\156\164\x5f\x70\x72\145\155\x69\165\155");
        if ($Rb) {
            goto dp;
        }
        if (!(isset($_GET["\163\164\141\x74\x65"]) && !empty($_GET["\x73\x74\141\164\145"]))) {
            goto PD;
        }
        $Yd = base64_decode(explode("\137", $_GET["\x73\164\x61\164\145"])[1]);
        $Yd = explode("\73", $Yd);
        $rL = $Yd[0];
        $n6 = isset($Yd[1]) ? $Yd[1] : site_url();
        PD:
        goto H2;
        dp:
        $rL = $Rb;
        H2:
        if (!empty($rL)) {
            goto hZ;
        }
        die("\116\157\40\x72\x65\161\x75\145\163\x74\40\146\157\165\156\x64\40\146\x6f\x72\x20\164\x68\x69\163\x20\141\160\x70\154\151\x63\x61\164\x69\x6f\156\56");
        hZ:
        $vQ = mo_oauth_client_get_option("\x6d\x6f\x5f\157\141\x75\x74\x68\137\x61\x70\x70\x73\x5f\x6c\x69\x73\x74");
        $Qu = $ie = $Xo = $p0 = $nY = $b3 = '';
        $X6 = false;
        foreach ($vQ as $OY => $AO) {
            if (!($OY == $rL)) {
                goto v0;
            }
            $X6 = $AO;
            v0:
            xw:
        }
        Yx:
        if ($X6) {
            goto Gh;
        }
        die("\101\x70\x70\x6c\x69\143\141\x74\x69\157\x6e\40\156\157\x74\40\x63\x6f\x6e\x66\x69\x67\x75\x72\145\x64\56");
        Gh:
        $Np = false;
        $pm = $X6["\162\x65\x64\x69\x72\x65\x63\x74\165\x72\151"];
        $uK = mo_oauth_client_get_option("\155\157\137\x6f\x61\165\164\150\137\144\x79\156\141\155\x69\143\137\143\x61\154\154\x62\x61\143\x6b\137\x75\162\154");
        if (empty($uK)) {
            goto zl;
        }
        $pm = $uK;
        zl:
        $L0 = new Mo_OAuth_Hanlder();
        if (isset($X6["\141\160\x70\x74\171\x70\145"]) && $X6["\141\x70\160\x74\x79\160\145"] == "\x6f\160\145\156\x69\x64\143\157\x6e\156\145\x63\x74") {
            goto Lq;
        }
        $KR = $X6["\141\143\143\x65\x73\x73\x74\157\x6b\145\156\x75\162\154"];
        if (!(strpos($KR, "\x67\157\157\147\154\x65") !== false)) {
            goto Z7;
        }
        $KR = "\150\164\x74\160\163\72\x2f\57\167\167\167\x2e\147\x6f\157\x67\154\x65\x61\x70\151\163\x2e\x63\157\155\57\157\141\165\164\x68\x32\57\166\x34\x2f\x74\x6f\x6b\x65\x6e";
        Z7:
        $Is = $L0->getAccessToken($KR, "\x61\165\164\x68\157\162\x69\x7a\x61\164\151\157\156\137\x63\x6f\144\x65", $X6["\143\x6c\x69\x65\x6e\164\151\x64"], $X6["\x63\154\x69\x65\x6e\x74\163\x65\x63\162\x65\164"], $_GET["\x63\157\144\x65"], $pm);
        $hf = $Is["\x61\143\143\x65\163\x73\137\164\x6f\x6b\x65\x6e"];
        if (!(count(explode("\x2e", $hf)) === 3)) {
            goto JY;
        }
        $QB = handleJWT($hf, false, $n6);
        JY:
        if ($hf) {
            goto HY;
        }
        die("\111\156\166\x61\x6c\x69\144\x20\x74\x6f\x6b\145\156\x20\x72\x65\143\145\x69\166\145\x64\56");
        HY:
        $h8 = isset($X6["\162\x65\163\157\165\x72\143\145\157\167\x6e\x65\162\x64\145\164\141\x69\x6c\x73\165\x72\x6c"]) ? $X6["\162\x65\x73\x6f\165\x72\x63\145\x6f\x77\156\x65\x72\144\145\x74\141\151\154\x73\165\x72\x6c"] : '';
        if (!(strpos($h8, "\x67\157\x6f\x67\154\145") !== false)) {
            goto qT;
        }
        $h8 = "\150\164\x74\x70\163\72\57\x2f\x77\x77\x77\56\x67\157\157\x67\x6c\145\x61\x70\x69\x73\56\143\x6f\x6d\x2f\157\x61\165\164\150\x32\x2f\x76\61\57\165\x73\x65\x72\151\156\146\157";
        qT:
        if (!(substr($h8, -1) == "\x3d")) {
            goto Ol;
        }
        $h8 .= $hf;
        Ol:
        $Y3 = array();
        if (empty($h8)) {
            goto zf;
        }
        $Y3 = $L0->getResourceOwner($h8, $hf);
        zf:
        if (!(isset($Y3["\x73\164\141\x74\x75\x73"]) && $Y3["\x73\164\x61\164\165\x73"] === "\x64\145\x63\154\x69\x6e\x65\144")) {
            goto Qd;
        }
        if (!(isset($Y3["\145\162\162\x6f\x72"]) && $Y3["\145\x72\x72\x6f\x72"] === "\141\x63\143\x65\163\163\137\164\157\153\x65\156\137\145\x78\160\151\162\x65\144")) {
            goto L7;
        }
        $l3 = $L0->getNewAccessToken($X6["\141\143\143\x65\163\x73\x74\157\153\x65\156\x75\162\154"], $X6["\143\154\x69\145\x6e\164\x69\x64"], $X6["\x63\154\x69\145\156\164\x73\x65\143\x72\145\x74"]);
        $Y3 = $L0->getResourceOwner($h8, $l3);
        L7:
        Qd:
        $qJ = isset($X6["\x67\x72\x6f\x75\x70\144\145\164\x61\151\154\163\x75\162\154"]) ? $X6["\x67\x72\157\165\x70\144\x65\x74\x61\x69\154\163\165\162\x6c"] : '';
        if (!(substr($qJ, -1) == "\x3d")) {
            goto cc;
        }
        $qJ .= $hf;
        cc:
        $Np = array();
        if (empty($qJ)) {
            goto Fs;
        }
        $Np = $L0->getResourceOwner($qJ, $hf);
        Fs:
        goto YB;
        Lq:
        $Is = $L0->getIdToken($X6["\141\143\x63\x65\x73\x73\x74\x6f\153\x65\x6e\x75\162\x6c"], "\141\x75\x74\150\x6f\162\x69\172\141\x74\x69\157\156\137\x63\157\144\145", $X6["\x63\x6c\x69\145\156\164\151\144"], $X6["\143\x6c\x69\145\x6e\164\x73\145\143\162\145\164"], $_GET["\x63\x6f\144\x65"], $pm);
        $sY = $Is["\x69\x64\x5f\x74\x6f\x6b\x65\x6e"];
        if ($sY) {
            goto h8;
        }
        die("\x49\156\x76\141\154\151\x64\x20\x74\157\153\x65\x6e\x20\162\145\143\x65\151\166\145\144\x2e");
        h8:
        $A7 = isset($X6["\152\x77\153\x73\x5f\x75\x72\x69"]) ? $X6["\152\167\153\163\137\x75\162\151"] : '';
        if (!($A7 != '')) {
            goto eY;
        }
        $ar = verify_from_jwks($X6["\152\167\153\x73\137\x75\162\x69"], $sY);
        if ($ar) {
            goto bq;
        }
        wp_die("\x54\x68\x65\162\145\x20\167\x61\x73\x20\x61\x20\x70\162\157\x62\154\x65\x6d\x20\166\141\x6c\151\x64\141\x74\x69\156\147\x20\164\150\145\x20\163\151\x67\156\141\164\x75\162\145");
        bq:
        eY:
        if (!($A7 != '' && $ar == "\x74\x72\165\x65" || $A7 == '')) {
            goto W7;
        }
        $Y3 = $L0->getResourceOwnerFromIdToken($sY);
        W7:
        YB:
        if (!(isset($QB) && is_array($QB) && is_array($Y3) && !empty($Y3))) {
            goto nd;
        }
        $Y3 = array_merge($QB, $Y3);
        nd:
        mo_oauth_client_handle_sso($rL, $X6, $Y3, $Np, $Is, $n6);
    } catch (Exception $C_) {
        die($C_->getMessage());
    }
    goto Ss;
    kc:
    if (isset($_GET["\145\x72\x72\x6f\x72\137\144\145\x73\143\x72\x69\x70\x74\151\x6f\x6e"])) {
        goto Yz;
    }
    if (!isset($_GET["\x65\162\x72\x6f\162"])) {
        goto ub;
    }
    die($_GET["\x65\x72\x72\x6f\162"]);
    ub:
    goto NO;
    Yz:
    die($_GET["\x65\162\x72\157\162\x5f\144\145\x73\x63\x72\151\160\x74\151\x6f\x6e"]);
    NO:
    die("\x49\x6e\x76\141\x6c\151\x64\x20\x72\145\163\160\157\x6e\x73\x65");
    Ss:
    rb:
    goto iG;
    n9:
    $rd = $_REQUEST["\141\x70\x70\x5f\156\x61\155\x65"];
    $vQ = mo_oauth_client_get_option("\155\157\137\157\141\165\164\150\x5f\141\x70\x70\x73\x5f\154\x69\x73\164");
    $n6 = isset($_REQUEST["\x72\145\144\151\162\145\x63\164\x5f\x75\x72\x6c"]) ? urldecode($_REQUEST["\x72\145\x64\151\162\145\x63\x74\x5f\165\x72\154"]) : site_url();
    setcookie("\x72\x65\144\151\x72\145\143\164\x5f\165\162\x6c", $n6);
    if (isset($_REQUEST["\164\145\x73\x74"])) {
        goto vl;
    }
    setcookie("\155\157\x5f\157\141\165\164\x68\137\164\x65\163\x74", false);
    goto ks;
    vl:
    setcookie("\x6d\x6f\137\x6f\x61\165\164\x68\137\x74\x65\163\164", true);
    ks:
    foreach ($vQ as $OY => $AO) {
        if (!($rd == $OY)) {
            goto mC;
        }
        $eC = str_shuffle(md5(time()));
        $c0 = $AO["\x61\x75\164\150\x6f\x72\x69\x7a\x65\165\162\154"];
        if (!(strpos($c0, "\x67\157\x6f\147\x6c\145") !== false)) {
            goto oQ;
        }
        $c0 = "\150\164\x74\x70\x73\x3a\x2f\57\141\x63\x63\x6f\x75\x6e\164\163\x2e\147\x6f\157\x67\154\145\x2e\x63\157\x6d\x2f\x6f\x2f\157\x61\165\x74\x68\62\57\x61\165\164\x68";
        oQ:
        $pm = $AO["\162\145\x64\151\x72\145\143\164\165\162\x69"];
        $uK = mo_oauth_client_get_option("\x6d\157\137\157\x61\165\164\150\137\x64\171\156\141\155\151\x63\x5f\x63\141\154\x6c\x62\141\143\153\x5f\165\x72\x6c");
        $ZW = mo_oauth_client_get_option("\x6d\x6f\x5f\157\141\x75\164\x68\x5f" . $rd . "\x5f\147\162\141\156\x74\137\164\x79\160\145");
        $Ld = intval(mo_oauth_client_get_option("\x6d\157\137\157\x61\165\x74\150\x5f" . $rd . "\137\x6a\x77\164\137\x73\165\x70\160\157\162\x74"));
        $Hu = "\143\157\x64\x65";
        if (!($ZW === "\111\155\x70\x6c\151\x63\x69\x74\40\107\x72\141\x6e\164")) {
            goto c6;
        }
        $Hu = "\x74\157\153\x65\156";
        c6:
        if (empty($uK)) {
            goto HK;
        }
        $pm = $uK;
        HK:
        if (strpos($c0, "\77") !== false) {
            goto Ms;
        }
        $c0 = $c0 . "\77\x63\x6c\x69\145\x6e\164\137\151\x64\75" . $AO["\143\x6c\x69\145\156\x74\151\x64"] . "\46\x73\143\x6f\x70\145\x3d" . $AO["\x73\143\157\160\145"] . "\x26\x72\145\144\x69\x72\x65\x63\164\137\x75\162\151\75" . $pm . "\46\x72\145\x73\160\157\x6e\x73\x65\x5f\x74\171\160\145\75" . $Hu . "\x26\x73\x74\x61\164\145\75" . $eC . "\x5f" . base64_encode($rd . "\73" . $n6);
        goto Zl;
        Ms:
        $c0 = $c0 . "\x26\143\x6c\151\145\156\164\x5f\x69\144\75" . $AO["\143\154\151\x65\156\164\x69\144"] . "\x26\x73\x63\x6f\x70\145\x3d" . $AO["\x73\143\157\x70\145"] . "\46\x72\x65\x64\x69\162\145\x63\x74\x5f\165\162\151\x3d" . $pm . "\x26\162\x65\x73\160\x6f\156\163\145\137\164\171\160\x65\x3d" . $Hu . "\x26\x73\164\x61\164\145\x3d" . $eC . "\x5f" . base64_encode($rd . "\73" . $n6);
        Zl:
        if (!(session_id() == '' || !isset($_SESSION))) {
            goto vJ;
        }
        session_start();
        vJ:
        wp_cache_set("\157\x61\x75\x74\x68\x32\163\x74\x61\x74\x65", $eC, "\155\x6f\137\x6f\x61\165\164\x68\137\x63\x6c\151\145\x6e\x74\x5f\160\162\145\155\x69\165\x6d");
        wp_cache_set("\141\x70\x70\x6e\141\x6d\145", $rd, "\x6d\x6f\x5f\157\141\x75\x74\x68\137\143\154\x69\145\x6e\164\137\x70\x72\x65\x6d\151\x75\155");
        header("\x4c\x6f\x63\141\164\151\x6f\x6e\x3a\40" . $c0);
        die;
        mC:
        yW:
    }
    O1:
    iG:
}
function is_jwt($kl, $CN)
{
    $fA = explode($CN, $kl);
    return is_array($fA) && sizeof($fA) > 2 ? true : false;
}
function handleJWT($kc, $lR = true, $n6 = '')
{
    $CN = "\56";
    $tP = explode($CN, $kc);
    if (!(sizeof($tP) > 2)) {
        goto i1;
    }
    list($TO, $qY, $Co) = explode($CN, $kc);
    $mO = base64_decode(strtr($Co, "\x2d\x5f", "\x2b\57"));
    $kr = utf8_decode($TO . $CN . $qY);
    $Xk = json_decode(base64_decode($qY));
    if (isset($Xk->exp) && !empty($Xk->exp)) {
        goto ul;
    }
    wp_die("\124\x68\145\40\x74\157\153\x65\156\40\x69\163\40\x69\156\x76\x61\154\151\x64\x2e\40\120\154\145\141\163\145\x20\x74\162\x79\40\154\x6f\147\x69\x6e\40\141\147\x61\x69\156\x2e");
    goto o9;
    ul:
    $oQ = time();
    if (!($oQ > $Xk->exp)) {
        goto gD;
    }
    wp_die("\x54\x68\145\40\x54\x6f\x6b\x65\156\x20\x68\x61\x73\x20\x65\170\x70\x69\x72\x65\144\x2e\x20\120\x6c\145\x61\x73\x65\40\x74\x72\x79\40\154\x6f\x67\x69\156\x20\x61\x67\x61\x69\x6e\56");
    if (!(isset($Xk->nbf) && !empty($Xk->nbf))) {
        goto u3;
    }
    if (!($oQ < $Xk->nbf)) {
        goto Qx;
    }
    wp_die("\x49\x74\x20\x69\x73\40\x74\x6f\157\x20\x65\141\162\x6c\x79\40\x74\x6f\40\x75\x73\x65\40\164\x68\151\163\x20\164\x6f\153\145\x6e\x2e\x20\120\154\145\141\163\145\40\x74\x72\x79\40\x4c\157\147\x69\156\40\141\147\x61\151\156\56");
    Qx:
    u3:
    gD:
    o9:
    $gU = "\163\x68\x61";
    $MF = json_decode(base64_decode($TO))->alg;
    if (strpos($MF, "\110\x53") !== false) {
        goto Ar;
    }
    if (!(strpos($MF, "\122\123") !== false)) {
        goto iM;
    }
    $NY = "\x52\x53\x41";
    $gU = explode("\122\123", $MF)[1];
    iM:
    goto df;
    Ar:
    $NY = "\x48\x53\101";
    $gU = explode("\110\123", $MF)[1];
    df:
    $vQ = mo_oauth_client_get_option("\155\x6f\137\x6f\x61\x75\x74\150\x5f\141\x70\x70\x73\137\x6c\151\x73\x74");
    $Qb = array_keys($vQ);
    $ve = end($Qb);
    $X6 = false;
    $rL = '';
    $ar = false;
    foreach ($vQ as $OY => $AO) {
        $E0 = '';
        if (!(isset($AO["\152\x77\153\163\137\x75\x72\151"]) && $AO["\x6a\167\153\x73\x5f\165\162\151"] !== '')) {
            goto qJ;
        }
        if (!(mo_oauth_client_get_option("\155\x6f\137\x6f\x61\165\164\x68\137" . $OY . "\137\152\x77\164\x5f\141\x6c\147\157") && mo_oauth_client_get_option("\155\x6f\137\x6f\x61\165\164\x68\137" . $OY . "\x5f\152\167\x74\x5f\141\154\x67\x6f") === "\122\123\x41")) {
            goto na;
        }
        $ar = verify_from_jwks($AO["\x6a\167\x6b\163\x5f\165\x72\151"], $kc);
        if (!$ar) {
            goto sP;
        }
        $X6 = $AO;
        $rL = $OY;
        sP:
        na:
        qJ:
        if (mo_oauth_client_get_option("\x6d\157\x5f\x6f\x61\165\164\x68\137" . $OY . "\137\x6a\x77\164\137\x61\154\147\x6f")) {
            goto Nk;
        }
        goto O8;
        goto N9;
        Nk:
        $E0 = mo_oauth_client_get_option("\x6d\157\137\157\141\165\164\150\x5f" . $OY . "\x5f\152\x77\x74\x5f\141\154\x67\x6f");
        if ($NY === "\x48\123\x41") {
            goto IQ;
        }
        if (!($NY === "\122\123\x41")) {
            goto zb;
        }
        if ($E0 === "\x52\x53\101") {
            goto Da;
        }
        if (!($ve === $OY)) {
            goto rJ;
        }
        wp_die("\x49\156\x76\141\154\x69\144\x20\x52\x65\x71\x75\x65\163\164\56");
        goto WP;
        rJ:
        goto dz;
        Da:
        if (mo_oauth_client_get_option("\155\x6f\137\x6f\x61\x75\164\x68\x5f" . $OY . "\137\170\x35\60\x39\x5f\x63\x65\x72\x74")) {
            goto Wm;
        }
        goto WP;
        goto oO;
        Wm:
        if (!$ar) {
            goto dJ;
        }
        $ar = true;
        $X6 = $AO;
        $rL = $OY;
        goto WP;
        dJ:
        $JW = mo_oauth_client_get_option("\155\x6f\137\x6f\x61\x75\164\150\137" . $OY . "\137\x78\x35\x30\x39\137\143\x65\x72\x74");
        $W9 = '';
        $Gm = explode("\55\55\x2d\x2d\x2d", $JW);
        if (preg_match("\57\x5c\x72\x5c\x6e\x7c\134\x72\x7c\x5c\156\57", $Gm[2])) {
            goto zZ;
        }
        $Dg = "\55\x2d\x2d\x2d\x2d" . $Gm[1] . "\x2d\x2d\55\x2d\x2d\12";
        $J8 = 0;
        ab:
        if (!($R8 = substr($Gm[2], $J8, 64))) {
            goto GU;
        }
        $Dg .= $R8 . "\12";
        $J8 += 64;
        goto ab;
        GU:
        $Dg .= "\55\55\x2d\55\55" . $Gm[3] . "\x2d\55\55\x2d\55\xa";
        $W9 = $Dg;
        goto Je;
        zZ:
        $W9 = $JW;
        Je:
        switch ($gU) {
            case "\x32\x35\66":
                $ar = openssl_verify($kr, $mO, $W9, OPENSSL_ALGO_SHA256);
                goto k3;
            case "\x33\x38\64":
                $ar = openssl_verify($kr, $mO, $W9, OPENSSL_ALGO_SHA384);
                goto k3;
            case "\x35\61\x32":
                $ar = openssl_verify($kr, $mO, $W9, OPENSSL_ALGO_SHA512);
                goto k3;
            default:
                $ar = false;
                goto k3;
        }
        Su:
        k3:
        oO:
        if (!$ar) {
            goto a6;
        }
        $rL = $OY;
        $X6 = $AO;
        goto WP;
        a6:
        dz:
        zb:
        goto jM;
        IQ:
        if ($E0 === "\110\123\101" && $mO === hash_hmac("\x73\150\141" . $gU, $kr, $AO["\x63\154\x69\145\x6e\x74\163\x65\143\x72\x65\x74"], true)) {
            goto GX;
        }
        if ($ve === $OY) {
            goto XT;
        }
        goto O8;
        goto ci;
        XT:
        wp_die("\x49\156\x76\141\154\x69\x64\x20\122\x65\x71\165\145\163\164\56");
        goto WP;
        ci:
        goto jo;
        GX:
        $ar = true;
        $X6 = $AO;
        $rL = $OY;
        goto WP;
        jo:
        jM:
        N9:
        O8:
    }
    WP:
    if ($ar) {
        goto zu;
    }
    if (mo_oauth_client_get_option("\x6d\x6f\x5f\157\x61\165\x74\x68\x5f" . $OY . "\137\152\167\164\137\141\x6c\147\157")) {
        goto In;
    }
    wp_die("\112\127\x54\x20\x53\165\160\x70\x6f\x72\x74\40\116\157\x74\x20\x45\156\141\x62\154\x65\144");
    In:
    wp_die("\111\x6e\166\141\x6c\x69\144\40\x53\151\x67\x6e\141\164\165\x72\145\56\40\120\154\x65\141\163\145\40\164\x72\171\x20\154\157\147\151\156\40\141\147\x61\151\156\56");
    goto Pk;
    zu:
    if ($X6) {
        goto Uj;
    }
    wp_die("\116\157\x20\x53\x75\143\x68\x20\101\x70\160\163\x20\x43\157\x6e\146\151\x67\x75\x72\145\144");
    Uj:
    if (!(mo_oauth_client_get_option("\x6d\157\137\157\141\165\x74\x68\137" . $rL . "\x5f\152\x77\164\137\163\165\x70\160\x6f\162\x74") && intval(mo_oauth_client_get_option("\155\x6f\137\x6f\x61\165\x74\x68\x5f" . $rL . "\x5f\x6a\x77\x74\x5f\163\x75\160\x70\x6f\162\164")) !== 1)) {
        goto ZI;
    }
    wp_die("\124\150\x65\40\x41\x70\x70\x6c\x69\x63\141\164\151\157\x6e\x20\x43\x6f\x6e\x66\151\147\x75\162\145\144\x20\144\157\x65\163\x20\156\x6f\164\40\x61\154\154\157\167\40\112\127\x54\40\151\156\40\162\145\x73\160\x6f\x6e\163\145\56");
    ZI:
    if (!isset($AO["\x75\163\x65\162\x6e\141\155\x65\x5f\141\164\x74\162"])) {
        goto dR;
    }
    $Qu = $AO["\x75\163\145\162\x6e\141\x6d\x65\x5f\141\x74\x74\162"];
    dR:
    if (!isset($AO["\x65\x6d\x61\x69\154\x5f\141\164\x74\162"])) {
        goto Ez;
    }
    $ie = $AO["\145\155\x61\x69\x6c\x5f\141\x74\164\162"];
    Ez:
    if (!isset($AO["\x66\151\162\163\x74\x6e\x61\155\145\137\x61\164\164\x72"])) {
        goto Fg;
    }
    $Xo = $AO["\x66\x69\162\x73\164\156\141\155\145\x5f\x61\164\164\x72"];
    Fg:
    if (!isset($AO["\x6c\x61\x73\x74\156\x61\x6d\145\137\x61\164\164\162"])) {
        goto sT;
    }
    $p0 = $AO["\x6c\141\x73\164\x6e\x61\x6d\145\137\141\x74\164\162"];
    sT:
    if (!isset($AO["\x64\x69\163\160\154\x61\171\x5f\x61\164\x74\162"])) {
        goto Yn;
    }
    $b3 = $AO["\x64\x69\x73\x70\154\141\x79\137\141\x74\x74\x72"];
    Yn:
    if (!mo_oauth_client_get_option("\155\157\x5f\157\x61\165\x74\150\x5f\143\x6c\x69\145\156\164\x5f" . $rL . "\x5f\x6d\141\160\x70\x69\156\147\137\147\162\x6f\165\160\x6e\141\x6d\145\137\x61\164\164\x72\x69\x62\165\164\x65")) {
        goto Sx;
    }
    $lG = mo_oauth_client_get_option("\155\157\x5f\157\x61\x75\x74\x68\x5f\143\x6c\x69\145\156\164\137" . $rL . "\137\x6d\x61\160\160\x69\x6e\x67\137\x67\162\x6f\165\x70\x6e\141\x6d\x65\x5f\x61\164\x74\162\x69\x62\x75\164\145");
    Sx:
    $Np = false;
    $pm = $X6["\162\145\144\x69\x72\x65\x63\164\x75\162\151"];
    $uK = mo_oauth_client_get_option("\x6d\157\x5f\x6f\141\165\x74\150\x5f\144\171\x6e\x61\155\151\143\137\x63\x61\154\154\x62\x61\x63\153\x5f\165\x72\154");
    if (empty($uK)) {
        goto RN;
    }
    $pm = $uK;
    RN:
    $qY = base64_decode($qY);
    $Y3 = json_decode($qY, true);
    if (!(isset($_GET["\164\145\x73\164"]) && $_GET["\x74\145\x73\x74"] == "\164\162\165\145" || isset($_COOKIE["\155\157\137\x6f\141\165\x74\x68\x5f\x74\x65\163\164"]) && $_COOKIE["\x6d\x6f\137\157\141\165\164\150\x5f\164\145\163\164"])) {
        goto uD;
    }
    echo "\x3c\x73\x74\171\x6c\145\x3e\x2e\x6d\x6f\157\x61\165\164\150\164\x65\163\164\x63\157\x6e\x66\151\x67\x74\141\x62\x6c\145\173\142\157\x72\144\x65\x72\55\x63\x6f\x6c\154\141\x70\x73\x65\72\x20\x63\x6f\x6c\154\x61\x70\x73\x65\73\175\x2e\155\157\157\x61\165\x74\150\164\x65\x73\x74\x63\x6f\156\x66\151\x67\x74\141\142\x6c\145\54\40\x2e\x6d\x6f\x6f\x61\x75\x74\150\x74\145\x73\x74\x63\x6f\156\x66\x69\147\164\x61\142\154\x65\40\x74\x64\x2c\x20\56\155\157\x6f\141\x75\x74\150\x74\x65\x73\164\x63\157\x6e\x66\151\x67\x74\x61\x62\154\145\x20\164\x68\40\173\142\157\162\x64\145\162\x3a\40\61\160\170\40\163\157\154\151\144\40\142\154\141\143\x6b\73\160\x61\x64\144\x69\x6e\x67\72\64\x70\x78\x7d\74\x2f\163\164\x79\x6c\x65\76";
    echo "\x3c\150\62\x3e\x4a\x57\124\x20\120\x61\171\154\157\x61\x64\74\x2f\x68\x32\x3e\x3c\x74\141\142\154\x65\x20\x63\x6c\141\163\x73\75\47\x6d\x6f\x6f\x61\x75\x74\x68\x74\145\163\x74\x63\157\x6e\146\151\147\164\x61\x62\154\145\47\76\74\x74\x72\76\74\164\x68\76\101\x74\164\x72\151\x62\x75\164\x65\x20\116\x61\x6d\x65\x3c\x2f\164\x68\x3e\x3c\164\x68\76\101\164\x74\162\151\x62\165\x74\145\40\126\x61\x6c\165\x65\x3c\57\164\x68\x3e\74\57\164\x72\76";
    test_attr_mapping_config('', $Y3, $Np);
    echo "\x3c\x2f\164\141\142\x6c\x65\76";
    if ($lR) {
        goto qF;
    }
    return $Y3;
    qF:
    die;
    uD:
    if ($lR) {
        goto Ct;
    }
    return $Y3;
    goto ey;
    Ct:
    $h9 = '';
    if (empty($Qu)) {
        goto ox;
    }
    $cS = getnestedattribute($Y3, $Qu);
    ox:
    if (empty($ie)) {
        goto Ab;
    }
    $rC = explode("\x20", $ie);
    foreach ($rC as $GN) {
        $M7 = getnestedattribute($Y3, $GN);
        if (!filter_var($M7, FILTER_VALIDATE_EMAIL)) {
            goto QV;
        }
        $jw = $M7;
        QV:
        mT:
    }
    eJ:
    Ab:
    if (empty($Xo)) {
        goto vw;
    }
    $Xo = getnestedattribute($Y3, $Xo);
    vw:
    if (empty($p0)) {
        goto fu;
    }
    $p0 = getnestedattribute($Y3, $p0);
    fu:
    if (empty($lG)) {
        goto kj;
    }
    if (isset($qJ) && !empty($qJ) && isset($Np) && $Np) {
        goto c2;
    }
    $nY = getnestedattribute($Y3, $lG);
    goto GP;
    c2:
    $nY = getnestedattribute($Np, $lG);
    GP:
    kj:
    if (empty($jw)) {
        goto DY;
    }
    if (!(strpos($jw, "\100") === false)) {
        goto vT;
    }
    if (!mo_oauth_client_get_option("\x6d\x6f\137\x61\143\164\151\x76\141\164\x65\x5f\165\163\x65\x72\x5f\141\156\x61\154\x79\164\x69\x63\x73")) {
        goto Ir;
    }
    $wY = attribute_failure();
    Mo_OAuth_User_Reports::add_transactions(isset($cS) && $cS ? $cS : '', Mo_Oauth_Constants::failure("\145\155\x61\151\x6c"), $rL, '', $wY["\143\154\151\145\x6e\164\151\160"], $wY["\x6e\141\x76\x69\147\x61\x74\x69\x6f\156\165\x72\x6c"]);
    Ir:
    wp_die("\x4d\141\160\x70\145\144\40\74\142\x3e\105\155\141\x69\154\x20\101\x74\x74\x72\x69\142\165\164\x65\74\57\x62\x3e\40\x69\163\x20\x6e\x6f\164\40\141\40\166\141\154\x69\144\x20\145\x6d\141\x69\154\x20\141\x64\144\x72\x65\163\163\56");
    die;
    vT:
    $Fp = mo_oauth_client_get_option("\x6d\x6f\x5f\157\x61\x75\164\x68\137\x63\x6c\151\145\x6e\x74\x5f\162\145\163\164\x72\151\x63\x74\145\144\137\144\157\x6d\141\x69\x6e\x73");
    if (empty($Fp)) {
        goto sv;
    }
    $qf = substr($jw, strpos($jw, "\x40") + 1);
    $M6 = explode("\54", $Fp);
    foreach ($M6 as $M6) {
        if (empty($M6)) {
            goto LI;
        }
        if (!($qf == $M6)) {
            goto wg;
        }
        wp_die("\x59\x6f\x75\x20\144\x6f\40\x6e\157\164\40\x68\141\166\x65\x20\x72\x69\x67\x68\x74\163\40\x74\x6f\x20\x61\143\143\145\163\163\40\x74\x68\151\163\x20\x70\x61\x67\x65\40\x2e\x20\x50\154\x65\x61\x73\x65\40\x63\157\x6e\x74\141\x63\164\x20\x79\x6f\165\x72\x20\141\x64\155\151\156\x69\163\x74\x72\141\x74\x6f\162");
        wg:
        LI:
        wJ:
    }
    I0:
    sv:
    goto oF;
    DY:
    if (!mo_oauth_client_get_option("\155\157\137\141\143\x74\x69\x76\141\x74\145\x5f\x75\x73\145\x72\x5f\141\156\141\x6c\x79\x74\151\x63\163")) {
        goto Z0;
    }
    $wY = attribute_failure();
    Mo_OAuth_User_Reports::add_transactions(isset($cS) && $cS ? $cS : '', Mo_Oauth_Constants::failure("\145\x6d\141\151\154"), $rL, '', $wY["\143\x6c\x69\x65\x6e\164\151\160"], $wY["\x6e\141\166\x69\147\x61\164\151\157\x6e\x75\x72\x6c"]);
    Z0:
    die("\x45\155\x61\151\x6c\40\x61\144\144\162\145\x73\163\40\x6e\157\164\40\162\x65\x63\145\x69\x76\x65\x64\56\x20\103\x68\145\143\x6b\40\171\157\x75\162\x20\74\142\76\x41\x74\164\162\x69\x62\165\x74\x65\40\x4d\x61\x70\x70\151\x6e\x67\x3c\x2f\142\76\40\143\157\156\146\x69\147\x75\x72\141\164\x69\157\x6e\56");
    oF:
    if (!empty($cS)) {
        goto nN;
    }
    $cS = $jw;
    nN:
    $h9 = $Xo . "\40" . $p0;
    if (empty($b3)) {
        goto s0;
    }
    if ($b3 == "\106\x4e\101\115\105") {
        goto j7;
    }
    if ($b3 == "\114\116\x41\115\x45") {
        goto lr;
    }
    if ($b3 == "\114\x4e\x41\115\x45\137\x46\116\101\x4d\x45") {
        goto YU;
    }
    if (!($b3 == "\x55\x53\x45\122\116\101\x4d\x45")) {
        goto zG;
    }
    $h9 = $cS;
    zG:
    goto Pq;
    YU:
    $h9 = $p0 . "\40" . $Xo;
    Pq:
    goto HT;
    lr:
    $h9 = $p0;
    HT:
    goto F2;
    j7:
    $h9 = $Xo;
    F2:
    s0:
    $user = get_user_by("\154\x6f\x67\x69\x6e", $cS);
    if ($user) {
        goto BD;
    }
    $user = get_user_by("\x65\155\141\151\154", $jw);
    BD:
    $Vw = false;
    if ($user) {
        goto zX;
    }
    if (mo_oauth_client_get_option("\x6d\x6f\137\157\141\x75\164\150\x5f\x63\x6c\x69\145\156\164\137\141\x75\164\157\137\x72\145\x67\x69\x73\164\145\x72") == 1) {
        goto ua;
    }
    if (!mo_oauth_client_get_option("\155\157\x5f\141\x63\164\x69\166\x61\x74\145\x5f\165\x73\x65\x72\x5f\x61\156\x61\x6c\x79\x74\x69\x63\x73")) {
        goto Se;
    }
    $wY = attribute_failure();
    Mo_OAuth_User_Reports::add_transactions(isset($cS) && $cS ? $cS : '', Mo_Oauth_Constants::failure("\162\145\147\151\x73\164\x72\141\164\151\x6f\x6e"), $rL, '', $wY["\143\154\x69\x65\x6e\164\151\x70"], $wY["\156\141\x76\151\x67\x61\164\x69\x6f\156\165\162\154"]);
    Se:
    wp_die("\122\145\147\151\163\x74\x72\141\x74\151\157\x6e\40\151\163\x20\144\x69\x73\x61\x62\154\145\144\x20\146\157\162\x20\x74\150\151\163\x20\x73\x69\x74\x65\56\40\x50\x6c\x65\141\x73\x65\40\x63\157\x6e\164\141\x63\164\x20\x79\x6f\x75\x72\40\x61\x64\155\x69\x6e\x69\x73\x74\x72\141\x74\157\x72");
    goto dN;
    ua:
    $Vw = true;
    $GC = wp_generate_password(10, false);
    $oO = wp_create_user($cS, $GC, $jw);
    $user = get_user_by("\x65\155\x61\151\154", $jw);
    wp_update_user(array("\x49\x44" => $oO, "\x66\151\x72\x73\x74\137\156\141\x6d\145" => $Xo, "\x6c\141\x73\x74\137\x6e\x61\x6d\x65" => $p0, "\144\x69\x73\160\x6c\x61\171\x5f\x6e\141\155\x65" => $h9));
    update_user_meta($user->ID, "\155\157\x5f\157\141\165\x74\150\x5f\x62\165\144\x64\x79\x70\x72\145\163\x73\x5f\141\x74\x74\x72\x69\142\165\x74\145\163", $Y3);
    dN:
    goto tm;
    zX:
    $oO = $user->ID;
    wp_update_user(array("\x49\x44" => $user->ID, "\x66\151\x72\x73\x74\x5f\x6e\141\155\x65" => $Xo, "\x6c\x61\163\x74\x5f\156\x61\155\145" => $p0, "\x64\151\163\160\154\141\171\x5f\156\141\x6d\x65" => $h9));
    update_user_meta($oO, "\155\x6f\x5f\x6f\x61\x75\x74\150\x5f\x62\165\144\144\x79\x70\162\145\163\163\x5f\x61\164\164\162\x69\142\x75\x74\x65\x73", $Y3);
    tm:
    if (!$oO) {
        goto KR;
    }
    if (mo_oauth_client_get_option("\x6d\x6f\137\x6f\141\165\x74\x68\x5f\143\154\151\x65\x6e\164\137\x63\165\x73\x74\x6f\x6d\137\141\x74\164\162\163\x5f\155\141\160\160\151\156\x67")) {
        goto jC;
    }
    $Rb = mo_oauth_client_get_option("\x6d\157\x5f\157\x61\x75\164\x68\x5f\x74\x65\x6d\160");
    $P3 = 0;
    yG:
    if (!($P3 <= $Rb)) {
        goto ii;
    }
    mo_oauth_client_delete_option("\x6d\x6f\x5f\157\x61\165\164\x68\137\164\x65\155\160\x5f\153\x65\171" . $P3);
    mo_oauth_client_delete_option("\x6d\x6f\137\157\x61\x75\164\x68\137\x63\x75\163\x74\x6f\155\x5f\x61\x74\x74" . $P3);
    d9:
    $P3++;
    goto yG;
    ii:
    goto Cg;
    jC:
    $Op = mo_oauth_client_get_option("\x6d\157\x5f\157\141\x75\164\x68\137\143\154\151\x65\156\x74\x5f\x63\x75\163\164\157\x6d\x5f\x61\164\164\x72\163\137\155\141\x70\160\x69\x6e\x67");
    $P3 = -1;
    foreach ($Op as $OY => $O2) {
        $P3++;
        $t9 = getnestedattribute($Y3, $O2);
        update_user_meta($oO, $OY, $t9);
        mo_oauth_client_update_option("\x6d\157\x5f\x6f\141\x75\x74\150\137\x63\165\x73\x74\157\x6d\x5f\x61\164\164" . $P3, $t9);
        mo_oauth_client_update_option("\155\x6f\x5f\x6f\x61\165\164\150\x5f\164\145\x6d\x70\137\x6b\x65\x79" . $P3, $OY);
        $Rb = mo_oauth_client_get_option("\x6d\x6f\137\157\141\x75\164\x68\137\164\145\x6d\160");
        if (!($Rb > $P3)) {
            goto NN;
        }
        $Wy = $P3 + 1;
        By:
        if (!($Wy <= $Rb)) {
            goto NH;
        }
        mo_oauth_client_delete_option("\155\x6f\x5f\157\x61\165\164\150\x5f\x74\145\x6d\160\x5f\153\x65\x79" . $Wy);
        mo_oauth_client_delete_option("\x6d\x6f\x5f\x6f\x61\x75\x74\x68\x5f\143\165\163\164\x6f\155\137\x61\x74\x74" . $Wy);
        Df:
        $Wy++;
        goto By;
        NH:
        NN:
        mo_oauth_client_update_option("\x6d\157\x5f\x6f\x61\165\164\150\137\x74\145\x6d\160", $P3);
        Tt:
    }
    rN:
    Cg:
    if (empty($nY)) {
        goto kb;
    }
    $C5 = new Mo_OAuth_Client_Role_Mapping();
    $C5->apply($oO, $rL, $nY, $Vw);
    kb:
    wp_set_current_user($oO);
    wp_set_auth_cookie($oO);
    if (!mo_oauth_client_get_option("\x6d\157\137\141\143\164\x69\166\141\x74\145\x5f\x75\163\x65\x72\137\x61\156\x61\x6c\x79\x74\151\x63\163")) {
        goto lI;
    }
    $wY = attribute_failure();
    Mo_OAuth_User_Reports::add_transactions($cS, Mo_Oauth_Constants::SUCCESS, $rL, $jw, $wY["\x63\154\151\145\x6e\164\151\x70"], $wY["\x6e\x61\166\151\x67\141\x74\x69\157\156\165\162\154"]);
    lI:
    $user = get_user_by("\111\x44", $oO);
    do_action("\x77\160\x5f\x6c\x6f\147\x69\x6e", $user->user_login, $user);
    do_action("\155\x6f\137\157\x61\165\x74\x68\x5f\154\157\x67\147\145\144\x5f\x69\x6e\137\x75\x73\x65\162\x5f\164\157\x6b\145\x6e", $kc, $user);
    $XL = home_url();
    wp_redirect($XL);
    die;
    KR:
    die;
    ey:
    Pk:
    i1:
}
function verify_from_jwks($A7, $sY)
{
    $BW = curl_init();
    curl_setopt($BW, CURLOPT_URL, $A7);
    curl_setopt($BW, CURLOPT_BINARYTRANSFER, true);
    curl_setopt($BW, CURLOPT_RETURNTRANSFER, true);
    $is = json_decode(curl_exec($BW));
    curl_close($BW);
    $bk = '';
    $xx = '';
    $Q6 = explode("\x2e", $sY);
    $uH = $Q6[0] . "\56" . $Q6[1];
    $KP = str_replace(array("\x2d", "\x5f"), array("\x2b", "\57"), $Q6[2]);
    $KP = base64_decode($KP);
    $NT = json_decode(base64_decode(str_replace(array("\55", "\x5f"), array("\x2b", "\x2f"), $Q6[0])), true);
    $MF = $NT["\x61\154\x67"];
    $LE = $NT["\153\x69\x64"];
    if ($is->keys) {
        goto o3;
    }
    return false;
    goto FD;
    o3:
    $zr = false;
    $PS = $is->keys;
    foreach ($PS as $OY => $O2) {
        $He = "\x66\x61\154\163\145";
        if ($O2->kid == $LE) {
            goto TU;
        }
        $He = "\146\x61\154\x73\x65";
        goto eB;
        TU:
        $He = "\x74\x72\165\145";
        $A6 = $O2->n;
        $A6 = str_replace(array("\55", "\x5f"), array("\x2b", "\x2f"), $A6);
        $A6 = base64_decode($A6);
        $C_ = $O2->e;
        $C_ = base64_decode($C_);
        $xP = new Crypt_RSA();
        $xP->loadKey(array("\x6e" => new Math_BigInteger($A6, 256), "\x65" => new Math_BigInteger($C_, 256)));
        $xP->setHash("\x73\150\141\x32\65\66");
        $xP->setSignatureMode(CRYPT_RSA_SIGNATURE_PKCS1);
        $ar = $xP->verify($uH, $KP);
        echo $ar ? "\x53\151\147\x6e\141\x74\x75\162\x65\x20\150\141\163\40\x62\145\x65\156\40\126\x61\154\x69\144\x61\164\145\144\x21\41\x21" : "\x49\156\x76\x61\154\x69\x64\40\123\151\x67\x6e\x61\x74\165\162\145\41\x21\x21";
        if (!$xP->verify($uH, $KP)) {
            goto Wd;
        }
        return true;
        Wd:
        goto D3;
        eB:
        CZ:
    }
    D3:
    if (!($He == "\x66\141\154\x73\x65")) {
        goto uA;
    }
    return false;
    uA:
    FD:
}
function mo_oauth_check_validity_of_entity($Ez, $xL, $RQ)
{
    $LF = $Ez ? $Ez : false;
    $Py = false;
    if ($LF) {
        goto JT;
    }
    $Py = false;
    goto F9;
    JT:
    if (strpos($LF, "\54") !== false) {
        goto uE;
    }
    if (!($LF == $xL)) {
        goto VD;
    }
    $Py = true;
    VD:
    goto B6;
    uE:
    $O0 = array_map("\x74\162\151\155", explode("\x2c", $LF));
    foreach ($O0 as $EG) {
        if (!($EG == $xL)) {
            goto f3;
        }
        $Py = true;
        goto WX;
        f3:
        c0:
    }
    WX:
    B6:
    F9:
    return $Py;
}
function test_attr_mapping_config($eL, $v5, $Np)
{
    test_attr_mapping_config_for_resource($eL, $v5);
    if (!$Np) {
        goto nQ;
    }
    echo "\x3c\57\x74\141\x62\x6c\145\76";
    echo "\74\150\64\76\107\162\157\165\160\x20\x49\156\x66\x6f\40\122\x65\163\x75\x6c\164\x3c\57\150\x34\76\74\164\x61\142\x6c\x65\76\x3c\x74\162\x3e\x3c\x74\x68\76\x41\164\x74\162\x69\x62\165\x74\x65\40\116\x61\155\145\x3c\57\164\x68\x3e\x3c\164\150\76\x41\x74\x74\162\x69\142\x75\164\x65\40\126\141\x6c\165\145\x3c\x2f\164\x68\76\74\x2f\164\x72\76";
    test_attr_mapping_config_for_resource($eL, $Np);
    nQ:
}
function test_attr_mapping_config_for_resource($eL, $v5)
{
    foreach ($v5 as $OY => $FT) {
        if (is_array($FT) || is_object($FT)) {
            goto r0;
        }
        echo "\74\x74\162\76\x3c\x74\x64\76";
        if (empty($eL)) {
            goto FP;
        }
        echo $eL . "\56";
        FP:
        echo $OY . "\x3c\57\x74\144\x3e\74\x74\x64\x3e" . $FT . "\74\57\x74\x64\76\74\57\x74\162\76";
        goto ce;
        r0:
        if (empty($eL)) {
            goto R0;
        }
        $eL .= "\56";
        R0:
        test_attr_mapping_config_for_resource($eL . $OY, $FT);
        ce:
        dx:
    }
    OC:
}
function mo_oauth_client_handle_sso($rL, $X6, $Y3, $Np, $Is, $n6)
{
    if (!(!is_array($Y3) || empty($Y3))) {
        goto LM;
    }
    echo "\x3c\x70\x3e\x43\x6f\x75\x6c\144\40\156\157\x74\x20\147\145\164\40\151\x6e\x66\157\x20\146\162\157\155\40\165\163\x65\x72\40\151\156\x66\157\40\145\156\x64\x70\x6f\x69\x6e\164\x2e\x20\111\164\x20\151\x73\x20\x65\151\x74\150\145\x72\x20\x65\155\x70\x74\x79\40\x6f\162\x20\151\x6e\166\x61\154\x69\x64\x2e\74\x2f\160\76";
    die;
    LM:
    $Qu = $ie = $Xo = $p0 = $nY = $b3 = '';
    if (!isset($X6["\165\163\x65\162\x6e\x61\155\x65\137\x61\164\x74\x72"])) {
        goto Uc;
    }
    $Qu = $X6["\x75\163\x65\162\x6e\141\x6d\x65\x5f\x61\x74\x74\x72"];
    Uc:
    if (!isset($X6["\x65\155\141\x69\x6c\x5f\x61\164\x74\162"])) {
        goto dE;
    }
    $ie = $X6["\x65\155\141\x69\x6c\137\141\164\164\x72"];
    dE:
    if (!isset($X6["\146\151\x72\163\164\156\x61\155\145\137\141\x74\x74\162"])) {
        goto zT;
    }
    $Xo = $X6["\x66\151\162\163\164\156\x61\155\145\137\x61\x74\x74\162"];
    zT:
    if (!isset($X6["\x6c\141\163\164\156\141\x6d\145\x5f\141\164\x74\x72"])) {
        goto kG;
    }
    $p0 = $X6["\x6c\x61\163\164\x6e\141\x6d\145\137\x61\x74\x74\x72"];
    kG:
    if (!isset($X6["\144\151\x73\160\x6c\x61\x79\137\141\164\164\162"])) {
        goto S4;
    }
    $b3 = $X6["\x64\x69\x73\160\154\141\x79\137\141\164\164\162"];
    S4:
    if (!mo_oauth_client_get_option("\x6d\x6f\x5f\x6f\141\165\164\150\x5f\143\x6c\151\145\x6e\x74\x5f" . $rL . "\137\x6d\141\160\160\x69\x6e\x67\x5f\x67\162\157\165\160\x6e\x61\155\x65\137\141\164\164\162\x69\142\165\164\x65")) {
        goto X7;
    }
    $lG = mo_oauth_client_get_option("\155\x6f\137\157\141\165\x74\x68\x5f\143\x6c\x69\145\156\x74\137" . $rL . "\137\155\x61\x70\160\151\156\x67\x5f\x67\162\157\x75\160\x6e\x61\x6d\x65\137\x61\164\x74\x72\151\142\x75\x74\x65");
    X7:
    $jw = '';
    if ($rL == "\x67\x6f\157\147\x6c\145") {
        goto a5;
    }
    if ($rL == "\x66\x61\x63\x65\142\x6f\x6f\x6b") {
        goto cT;
    }
    if (!($rL == "\167\x69\156\x64\157\167\163")) {
        goto VB;
    }
    if (!isset($Y3["\x65\x6d\x61\x69\x6c\x73"]["\x70\x72\145\x66\145\x72\x72\145\x64"])) {
        goto mg;
    }
    $jw = $Y3["\145\155\141\151\x6c\163"]["\x70\162\145\x66\x65\x72\162\145\144"];
    mg:
    if (!isset($Y3["\x6e\141\155\145"])) {
        goto ZV;
    }
    $Xo = $Y3["\156\x61\x6d\x65"];
    ZV:
    VB:
    goto LH;
    cT:
    if (!isset($Y3["\145\155\x61\x69\154"])) {
        goto WH;
    }
    $jw = $Y3["\145\155\x61\151\x6c"];
    WH:
    if (!isset($Y3["\x6e\x61\155\x65"])) {
        goto I_;
    }
    $Xo = $Y3["\x6e\141\155\x65"];
    I_:
    LH:
    goto GV;
    a5:
    if (!isset($Y3["\145\x6d\x61\x69\x6c\x73"])) {
        goto UI;
    }
    foreach ($Y3["\145\155\x61\x69\x6c\163"] as $jw) {
        if (!isset($jw["\x76\x61\154\x75\x65"])) {
            goto Kn;
        }
        $jw = $jw["\166\x61\x6c\x75\x65"];
        goto kJ;
        Kn:
        l1:
    }
    kJ:
    UI:
    if (!isset($Y3["\144\x69\163\x70\x6c\141\171\116\x61\155\x65"])) {
        goto oc;
    }
    $Xo = $Y3["\144\x69\x73\160\154\x61\x79\x4e\141\155\145"];
    oc:
    GV:
    if (!(isset($_COOKIE["\155\157\x5f\157\141\x75\x74\150\x5f\164\145\x73\164"]) && $_COOKIE["\x6d\x6f\x5f\x6f\x61\165\x74\x68\137\164\145\163\164"])) {
        goto Sn;
    }
    echo "\x3c\x73\164\171\x6c\145\76\56\155\157\x6f\141\x75\x74\150\x74\x65\163\164\x63\157\156\x66\151\147\164\x61\x62\x6c\145\x7b\142\x6f\x72\144\145\162\x2d\x63\157\x6c\154\141\x70\x73\145\x3a\x20\x63\157\154\x6c\141\x70\x73\x65\x3b\x7d\56\x6d\x6f\157\x61\165\164\x68\x74\145\x73\x74\x63\157\156\146\151\147\164\141\142\x6c\145\x2c\x20\56\x6d\x6f\x6f\141\x75\164\x68\x74\x65\x73\x74\x63\x6f\x6e\x66\x69\x67\164\141\x62\154\x65\x20\x74\x64\54\40\56\155\157\x6f\x61\x75\x74\x68\x74\x65\x73\164\x63\x6f\156\146\151\x67\x74\141\142\154\x65\40\x74\x68\x20\x7b\x62\157\x72\144\x65\x72\72\x20\61\x70\x78\x20\x73\157\x6c\x69\144\x20\x62\154\x61\143\153\73\160\141\144\144\151\156\x67\x3a\x34\160\x78\175\74\x2f\x73\x74\x79\x6c\145\x3e";
    echo "\x3c\x68\62\76\124\x65\163\x74\x20\x43\x6f\x6e\x66\x69\147\165\162\141\x74\x69\x6f\x6e\x3c\x2f\150\x32\76\x3c\x74\x61\x62\154\145\x20\x63\154\141\x73\x73\x3d\x27\x6d\x6f\157\141\x75\x74\x68\164\145\x73\x74\143\x6f\x6e\146\x69\147\164\141\x62\154\x65\x27\76\74\x74\162\x3e\74\x74\x68\x3e\101\164\164\x72\x69\x62\165\x74\145\x20\x4e\x61\155\145\x3c\x2f\x74\x68\76\x3c\x74\x68\x3e\101\164\x74\162\x69\x62\165\164\145\x20\x56\x61\154\165\x65\74\57\x74\x68\x3e\74\57\164\x72\76";
    test_attr_mapping_config('', $Y3, $Np);
    echo "\x3c\x2f\x74\x61\x62\x6c\145\76";
    die;
    Sn:
    $h9 = '';
    if (empty($Qu)) {
        goto mE;
    }
    $cS = getnestedattribute($Y3, $Qu);
    mE:
    if (empty($ie)) {
        goto dP;
    }
    $rC = explode("\x20", $ie);
    foreach ($rC as $GN) {
        $M7 = getnestedattribute($Y3, $GN);
        if (!filter_var($M7, FILTER_VALIDATE_EMAIL)) {
            goto Gk;
        }
        $jw = $M7;
        Gk:
        Dh:
    }
    CR:
    dP:
    if (empty($Xo)) {
        goto x3;
    }
    $Xo = getnestedattribute($Y3, $Xo);
    x3:
    if (empty($p0)) {
        goto Vg;
    }
    $p0 = getnestedattribute($Y3, $p0);
    Vg:
    if (empty($lG)) {
        goto ud;
    }
    if (isset($qJ) && !empty($qJ) && isset($Np) && $Np) {
        goto Ba;
    }
    $nY = getnestedattribute($Y3, $lG);
    goto l6;
    Ba:
    $nY = getnestedattribute($Np, $lG);
    l6:
    ud:
    if (empty($jw)) {
        goto vv;
    }
    if (!(strpos($jw, "\100") === false)) {
        goto tK;
    }
    if (!mo_oauth_client_get_option("\x6d\157\x5f\141\x63\x74\x69\x76\141\164\x65\x5f\x75\x73\x65\162\x5f\x61\x6e\141\x6c\x79\x74\x69\143\163")) {
        goto cH;
    }
    $wY = attribute_failure();
    Mo_OAuth_User_Reports::add_transactions(isset($cS) && $cS ? $cS : '', Mo_Oauth_Constants::failure("\145\x6d\141\151\154"), $rL, '', $wY["\143\154\x69\145\156\x74\x69\x70"], $wY["\x6e\x61\x76\151\147\x61\x74\151\x6f\x6e\x75\x72\154"]);
    cH:
    wp_die("\x4d\x61\160\x70\x65\144\40\x3c\x62\76\105\155\141\151\154\40\101\x74\164\162\x69\142\x75\164\x65\74\57\x62\76\x20\151\163\x20\156\x6f\x74\x20\141\40\166\x61\x6c\x69\144\x20\145\x6d\x61\151\x6c\40\x61\x64\144\162\x65\x73\x73\x2e");
    die;
    tK:
    $G0 = false;
    $Fp = mo_oauth_client_get_option("\155\157\137\157\x61\165\164\x68\137\x63\154\x69\145\x6e\164\x5f\x72\145\163\x74\162\x69\143\164\x65\x64\137\144\x6f\x6d\x61\151\156\163");
    if (empty($Fp)) {
        goto U3;
    }
    $qf = substr($jw, strpos($jw, "\100") + 1);
    $M6 = explode("\x2c", $Fp);
    foreach ($M6 as $M6) {
        if (empty($M6)) {
            goto lC;
        }
        if (!($qf == $M6)) {
            goto Ix;
        }
        $G0 = true;
        goto wz;
        Ix:
        lC:
        tk:
    }
    wz:
    if (!($G0 == false)) {
        goto vb;
    }
    wp_die("\131\x6f\x75\x20\x64\157\x20\x6e\157\x74\40\150\x61\x76\x65\40\162\x69\x67\150\x74\163\x20\164\157\40\141\x63\x63\145\163\x73\x20\x74\x68\x69\163\x20\160\x61\147\x65\x20\56\x20\120\x6c\145\141\x73\145\40\x63\x6f\156\x74\141\x63\x74\40\x79\x6f\x75\162\x20\x61\144\155\x69\x6e\x69\x73\x74\162\x61\164\x6f\x72");
    vb:
    U3:
    goto uq;
    vv:
    if (!mo_oauth_client_get_option("\155\x6f\137\141\143\x74\151\166\x61\x74\x65\137\x75\163\145\162\137\x61\156\141\154\171\x74\x69\143\163")) {
        goto Jl;
    }
    $wY = attribute_failure();
    Mo_OAuth_User_Reports::add_transactions(isset($cS) && $cS ? $cS : '', Mo_Oauth_Constants::failure("\x65\x6d\x61\x69\154"), $rL, '', $wY["\143\154\151\145\x6e\x74\151\x70"], $wY["\156\141\166\x69\147\141\x74\151\x6f\x6e\165\x72\154"]);
    Jl:
    die("\105\155\141\x69\154\40\141\144\144\x72\145\163\163\x20\x6e\157\164\x20\162\145\143\145\x69\166\x65\x64\56\x20\x43\x68\x65\143\x6b\40\171\x6f\165\x72\x20\x3c\x62\76\x41\164\x74\162\x69\142\x75\x74\145\x20\x4d\x61\160\160\x69\156\147\x3c\x2f\142\76\40\143\x6f\156\146\151\x67\x75\x72\141\164\151\x6f\x6e\x2e");
    uq:
    if (!empty($cS)) {
        goto hB;
    }
    $cS = $jw;
    hB:
    $h9 = $Xo . "\x20" . $p0;
    if (empty($b3)) {
        goto mv;
    }
    if ($b3 == "\x46\x4e\101\x4d\x45") {
        goto VG;
    }
    if ($b3 == "\114\x4e\x41\x4d\105") {
        goto lV;
    }
    if ($b3 == "\x4c\x4e\101\x4d\105\137\106\116\101\x4d\x45") {
        goto z8;
    }
    if (!($b3 == "\125\x53\x45\x52\x4e\101\115\x45")) {
        goto Vn;
    }
    $h9 = $cS;
    Vn:
    goto KA;
    z8:
    $h9 = $p0 . "\x20" . $Xo;
    KA:
    goto CF;
    lV:
    $h9 = $p0;
    CF:
    goto tM;
    VG:
    $h9 = $Xo;
    tM:
    mv:
    $user = get_user_by("\x6c\157\x67\151\156", $cS);
    if ($user) {
        goto qD;
    }
    $user = get_user_by("\145\155\x61\x69\154", $jw);
    qD:
    $Vw = false;
    if ($user) {
        goto wm;
    }
    if (mo_oauth_client_get_option("\x6d\157\x5f\x6f\141\165\x74\150\137\x63\154\x69\x65\x6e\x74\x5f\x61\x75\164\x6f\x5f\x72\x65\147\151\163\x74\x65\x72") == 1) {
        goto eo;
    }
    if (!mo_oauth_client_get_option("\x6d\157\x5f\x61\143\x74\151\x76\141\164\x65\x5f\165\x73\145\x72\x5f\x61\156\x61\x6c\x79\164\151\143\x73")) {
        goto aM;
    }
    $wY = attribute_failure();
    Mo_OAuth_User_Reports::add_transactions(isset($cS) && $cS ? $cS : '', Mo_Oauth_Constants::failure("\x72\x65\147\151\163\164\x72\x61\x74\151\157\x6e"), $rL, '', $wY["\143\154\x69\x65\156\164\151\160"], $wY["\x6e\141\166\x69\147\x61\164\151\x6f\x6e\165\x72\154"]);
    aM:
    wp_die("\122\x65\x67\x69\163\164\x72\141\164\x69\157\x6e\x20\151\x73\x20\x64\151\163\x61\142\x6c\x65\144\x20\146\157\162\40\164\x68\151\x73\x20\x73\151\x74\145\56\40\120\154\145\141\x73\x65\40\x63\157\156\x74\141\143\164\40\x79\157\x75\162\40\x61\144\155\x69\x6e\x69\163\164\x72\141\164\157\x72");
    goto J3;
    eo:
    $Vw = true;
    $GC = wp_generate_password(10, false);
    $oO = wp_create_user($cS, $GC, $jw);
    $user = get_user_by("\x65\155\x61\x69\154", $jw);
    wp_update_user(array("\111\x44" => $oO, "\x66\151\162\163\164\x5f\x6e\x61\x6d\x65" => $Xo, "\x6c\x61\163\x74\x5f\x6e\141\155\145" => $p0, "\x64\151\163\160\x6c\141\171\137\x6e\141\x6d\145" => $h9));
    update_user_meta($user->ID, "\x6d\x6f\137\157\x61\165\x74\x68\137\x62\x75\x64\x64\x79\160\162\145\x73\163\137\x61\164\164\162\x69\142\x75\x74\145\x73", $Y3);
    J3:
    goto a4;
    wm:
    $oO = $user->ID;
    wp_update_user(array("\111\104" => $user->ID, "\x66\151\x72\163\x74\137\156\x61\155\x65" => $Xo, "\x6c\x61\x73\164\x5f\x6e\141\x6d\145" => $p0, "\x64\x69\x73\160\154\x61\171\137\156\x61\x6d\145" => $h9));
    update_user_meta($oO, "\155\x6f\x5f\x6f\x61\165\x74\150\x5f\142\165\144\144\x79\160\162\145\x73\x73\137\141\164\x74\x72\151\x62\x75\x74\145\163", $Y3);
    a4:
    if (!$oO) {
        goto MD;
    }
    if (mo_oauth_client_get_option("\155\x6f\137\157\141\165\x74\150\137\x63\x6c\x69\145\156\x74\x5f\x63\x75\x73\x74\157\x6d\137\141\164\164\162\163\137\155\x61\160\160\x69\156\x67")) {
        goto Gs;
    }
    $Rb = mo_oauth_client_get_option("\155\157\x5f\x6f\x61\x75\x74\x68\137\164\x65\x6d\x70");
    $P3 = 0;
    uQ:
    if (!($P3 <= $Rb)) {
        goto XY;
    }
    mo_oauth_client_delete_option("\155\157\137\157\141\x75\x74\x68\137\164\145\x6d\160\x5f\153\145\171" . $P3);
    mo_oauth_client_delete_option("\155\x6f\x5f\x6f\x61\165\x74\150\x5f\x63\x75\x73\x74\x6f\155\137\x61\x74\x74" . $P3);
    eV:
    $P3++;
    goto uQ;
    XY:
    goto U2;
    Gs:
    $Op = mo_oauth_client_get_option("\155\x6f\137\157\x61\x75\164\x68\x5f\143\x6c\151\145\156\164\x5f\143\x75\x73\x74\157\x6d\x5f\x61\x74\164\x72\163\137\155\x61\160\x70\x69\156\147");
    $P3 = -1;
    foreach ($Op as $OY => $O2) {
        $P3++;
        $t9 = getnestedattribute($Y3, $O2);
        update_user_meta($oO, $OY, $t9);
        mo_oauth_client_update_option("\x6d\x6f\137\x6f\x61\x75\164\150\137\143\165\163\164\157\155\x5f\141\x74\164" . $P3, $t9);
        mo_oauth_client_update_option("\155\157\137\157\x61\165\164\x68\x5f\x74\145\155\160\137\x6b\145\x79" . $P3, $OY);
        $Rb = mo_oauth_client_get_option("\155\157\x5f\x6f\x61\165\164\150\x5f\x74\145\155\160");
        if (!($Rb > $P3)) {
            goto ES;
        }
        $Wy = $P3 + 1;
        Ln:
        if (!($Wy <= $Rb)) {
            goto Lm;
        }
        mo_oauth_client_delete_option("\155\157\x5f\x6f\x61\165\164\150\x5f\x74\145\x6d\160\x5f\153\145\x79" . $Wy);
        mo_oauth_client_delete_option("\155\x6f\137\x6f\x61\x75\x74\x68\x5f\x63\165\x73\x74\157\155\x5f\x61\x74\x74" . $Wy);
        oy:
        $Wy++;
        goto Ln;
        Lm:
        ES:
        mo_oauth_client_update_option("\x6d\157\137\157\141\x75\164\x68\x5f\x74\145\x6d\160", $P3);
        cn:
    }
    WF:
    U2:
    if (empty($nY)) {
        goto KE;
    }
    $C5 = new Mo_OAuth_Client_Role_Mapping();
    $C5->apply($oO, $rL, $nY, $Vw);
    KE:
    wp_set_current_user($oO);
    wp_set_auth_cookie($oO);
    if (!mo_oauth_client_get_option("\155\157\137\141\x63\x74\151\166\141\164\x65\x5f\165\163\x65\x72\137\x61\156\x61\154\x79\164\x69\143\x73")) {
        goto Ow;
    }
    $wY = attribute_failure();
    Mo_OAuth_User_Reports::add_transactions($cS, Mo_Oauth_Constants::SUCCESS, $rL, $jw, $wY["\143\x6c\151\145\x6e\x74\151\160"], $wY["\x6e\141\x76\x69\147\141\164\151\x6f\156\165\x72\x6c"]);
    Ow:
    $user = get_user_by("\x49\x44", $oO);
    do_action("\167\x70\137\x6c\x6f\x67\x69\156", $user->user_login, $user);
    if (!is_array($Is)) {
        goto oq;
    }
    do_action("\x6d\157\137\x6f\141\x75\x74\150\x5f\x6c\157\x67\x67\x65\x64\137\x69\156\137\165\x73\x65\162\x5f\164\x6f\x6b\x65\156", $Is, $user);
    oq:
    $dE = wp_cache_get("\157\141\165\164\150\x5f\162\145\160\x6c\141\171\163\x74\x61\x74\x65", "\x6d\157\137\x6f\x61\x75\x74\x68\x5f\143\x6c\x69\145\156\x74\137\160\162\145\x6d\x69\x75\155");
    if (!isset($_COOKIE["\162\145\x64\151\162\145\143\x74\x5f\x75\x72\154"])) {
        goto tP;
    }
    $n6 = $_COOKIE["\x72\x65\144\x69\x72\x65\x63\x74\137\x75\162\x6c"];
    tP:
    if (mo_oauth_client_get_option("\x6d\157\137\157\141\x75\x74\150\137\x63\154\x69\145\156\164\x5f\x61\x66\x74\x65\x72\x5f\154\x6f\147\151\156\137\x75\162\x6c") && mo_oauth_client_get_option("\x6d\x6f\137\x6f\141\x75\x74\x68\x5f\143\154\x69\x65\156\x74\x5f\141\146\164\x65\x72\x5f\x6c\157\x67\151\156\137\165\x72\x6c") != '') {
        goto bH;
    }
    if ($dE !== false) {
        goto dm;
    }
    $XL = isset($n6) ? $n6 : site_url();
    goto g_;
    dm:
    $XL = $dE;
    g_:
    goto Ws;
    bH:
    $XL = mo_oauth_client_get_option("\x6d\157\x5f\x6f\141\165\x74\150\x5f\143\154\151\145\x6e\x74\137\141\x66\164\145\x72\137\154\x6f\147\151\x6e\x5f\165\x72\x6c");
    Ws:
    if (mo_oauth_client_get_option("\155\x6f\137\157\x61\165\164\150\137\143\x6c\x69\x65\156\x74\x5f\x70\x6f\x70\165\x70\137\x6c\157\147\151\x6e")) {
        goto hK;
    }
    wp_redirect($XL);
    goto pZ;
    hK:
    echo "\x3c\x73\143\x72\151\x70\164\x3e\x77\151\156\x64\157\167\x2e\x6f\x70\145\156\x65\x72\56\x48\x61\156\x64\x6c\145\x50\157\160\165\160\122\x65\x73\x75\x6c\x74\50\x22" . $XL . "\42\51\73\167\151\x6e\144\x6f\167\56\143\x6c\x6f\163\145\50\51\x3b\x3c\x2f\163\x63\162\x69\160\x74\x3e";
    pZ:
    die;
    MD:
}
function getnestedattribute($FT, $OY)
{
    if (!empty($OY)) {
        goto Ib;
    }
    return '';
    Ib:
    $PS = explode("\56", $OY);
    if (sizeof($PS) > 1) {
        goto Dn;
    }
    $u9 = $PS[0];
    if (!isset($FT[$u9])) {
        goto Jg;
    }
    if (is_array($FT[$u9])) {
        goto iD;
    }
    return $FT[$u9];
    goto q9;
    iD:
    return $FT[$u9][0];
    q9:
    Jg:
    goto o5;
    Dn:
    $u9 = $PS[0];
    if (!isset($FT[$u9])) {
        goto Dz;
    }
    return getnestedattribute($FT[$u9], str_replace($u9 . "\56", '', $OY));
    Dz:
    o5:
    return '';
}
function attribute_failure()
{
    if (mo_oauth_client_get_option("\x6d\157\x5f\157\x61\165\164\x68\137\143\x6c\x69\x65\156\x74\x5f\141\146\x74\x65\x72\x5f\154\157\147\151\156\137\x75\x72\x6c") && mo_oauth_client_get_option("\x6d\157\x5f\x6f\x61\165\164\150\x5f\143\x6c\x69\145\156\x74\137\141\x66\164\x65\162\137\154\x6f\147\151\x6e\137\165\x72\154") != '') {
        goto Pw;
    }
    $XL = home_url();
    goto qA;
    Pw:
    $XL = mo_oauth_client_get_option("\155\157\137\x6f\141\165\164\x68\x5f\x63\x6c\x69\145\156\x74\x5f\x61\146\164\145\162\137\x6c\x6f\147\x69\x6e\x5f\x75\162\154");
    qA:
    return array("\x6e\141\166\151\147\x61\164\x69\x6f\x6e\x75\162\x6c" => $XL, "\143\154\151\x65\x6e\164\151\160" => $_SERVER["\122\x45\115\117\124\105\137\101\104\104\122"]);
}
function register_mo_oauth_widget()
{
    register_widget("\x6d\157\x5f\157\141\165\x74\150\x5f\167\x69\x64\147\x65\x74");
}
add_action("\167\151\144\x67\145\164\163\x5f\151\x6e\151\164", "\162\x65\147\151\163\x74\x65\x72\137\x6d\x6f\137\157\x61\165\x74\x68\x5f\x77\x69\144\x67\x65\164");
add_action("\151\156\x69\x74", "\x6d\x6f\x5f\x6f\141\165\x74\150\x5f\x6c\x6f\x67\151\x6e\x5f\166\141\x6c\x69\144\141\164\145");
?>
